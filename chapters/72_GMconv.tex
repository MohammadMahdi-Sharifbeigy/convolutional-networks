%!TEX root=../GaugeCNNTheory.tex


\subsection{تبدیلات میدان کرنل و کانولوشن‌های \lr{GM}}
\label{sec:global_conv}

اکنون به سراغ تبدیلات میدان کرنل و کانولوشن‌های $\GM$ با کرنل‌های (کانولوشنی) با گستره فضایی می‌رویم.
بخش~\ref{sec:kernel_fields} میدان‌های کرنل عمومی و بدون قید و میدان‌های کرنل کانولوشنی $\GM$ خاص‌تری را معرفی می‌کند که بر اساس یک کرنل الگوی مشترک و \lr{G}-هدایت‌پذیر تعریف می‌شوند.
تبدیلات میدان کرنل عمومی و کانولوشن‌های $\GM$ در بخش~\ref{sec:KFTs_GM-conv_global} معرفی می‌شوند.
از آنجایی که هر دو به صورت \emph{سراسری} تعریف شده‌اند، فرمول‌بندی آنها لزوماً \emph{مستقل از مختصات} است.
بخش~\ref{sec:KFTs_GM-conv_local} هر دو عمل را نسبت به بدیهی‌سازی‌های محلی بیان می‌کند و تعاریف محلی ما را از بخش~\ref{sec:gauge_conv_main} بازیابی می‌کند.





\subsubsection[میدان‌های کرنل]{میدان‌های کرنل مستقل از مختصات و کرنل‌های \lr{G}-هدایت‌پذیر}
\label{sec:kernel_fields}

برای تشخیص الگوهای فضایی در میدان‌های ویژگی، شبکه‌های کانولوشنی از کرنل‌های با گستره فضایی استفاده می‌کنند که به صورت خطی ویژگی‌ها را از یک همسایگی محلی در اطراف هر نقطه جمع‌آوری می‌کنند.
در معادله~\eqref{eq:conv_kernel_unrestricted} ما کرنل‌های الگوی (بدون قید) را برای یک منیفلد $d$-بعدی و میدان‌های ویژگی ورودی و خروجی با ابعاد $\cin$ و $\cout$ به عنوان نگاشت‌های
$K: \R^d \to \R^{\cout\times\cin}$
تعریف کردیم که به هر نقطه از دامنه خود یک ماتریس $\cout\times\cin$ اختصاص می‌دهند.
تعریف کرنل‌های کانولوشن به عنوان نگاشت‌هایی با دامنه $\R^d\cong \TpM$ و هم‌دامنه $\R^{\cout\times\cin}\cong \Hom(\Ainp,\Aoutp)$ یک تعریف مستقل از مختصات برای کرنل‌ها
به عنوان نگاشت‌هایی بین فضاهای مماس و فضاهای هومومورفیسم متناظر پیشنهاد می‌کند:

\begin{dfn}[میدان کرنل]
\label{dfn:kernel_field_general}
    ما \emph{میدان‌های کرنل} (بدون قید) از نوع $\rhoin,\rhoout$ را روی یک منیفلد $M$ به عنوان \lr{M}-مورفیسم‌های کلاف هموار بین کلاف مماس $\TM$ و کلاف هومومورفیسم بردار ویژگی $\Hom(\Ain,\Aout)$ تعریف می‌کنیم.
    بر اساس تعریفش به عنوان یک \lr{M}-مورفیسم، یک میدان کرنل $\K$ باعث جابجایی نمودار زیر می‌شود:
    \begin{equation}\label{eq:kernel_bundle_map}
        \begin{tikzcd}[row sep=3.5em, column sep=2.5em]
            % ROW 1
            \TM  \arrow[rd, start anchor={[xshift=-1ex]}, "\piTM"']
                \arrow[rr, "\K"]
            & &
            \mkern-3mu
            \Hom(\Ain,\Aout)
                \arrow[ld, start anchor={[xshift=-3ex]}, shorten >=.1ex, shorten <=-.75ex, "\piHom"] \\
            % ROW 2
            & M &
        \end{tikzcd}
    \end{equation}
    با وجود نگاشت هموار بین دو کلاف برداری، فرض نمی‌شود که $\K$ یک مورفیسم \emph{کلاف برداری} باشد، یعنی، فرض نمی‌شود که محدودیت‌های $\Kp: \TpM \to \Hom(\Ainp, \Aoutp)$ خطی باشند.%
    \footnote{
        این نشان می‌دهد که کرنل‌های کانولوشن به طور کلی به عنوان نگاشت‌های $K:\R^d \to \R^{\cout\times\cin}$ خطی نیستند.
        توجه داشته باشید که این با خطی بودن $K(\mathscr{v}) \in \R^{\cout\times\cin}$ (به عنوان نگاشت $\R^{\cin} \to \R^{\cout}$) برای هر $\mathscr{v}\in\R$ یا، در اینجا، خطی بودن $\Kp(v) \in \Hom(\Ainp,\Aoutp)$ (به عنوان نگاشت $\Ainp \to \Aoutp$) برای هر $v\in\TpM$ تداخلی ندارد.
    }
\end{dfn}
نام \emph{میدان کرنل} از این واقعیت ناشی می‌شود که نگاشت‌های کلاف تعریف‌شده به این شکل $\K$ یک کرنل مستقل از مختصات (بالقوه متفاوت) $\Kp: \TpM \to \Hom(\Ainp,\Aoutp)$ را به هر نقطه $p$ از منیفلد اختصاص می‌دهند.%
\footnote{
    ما انتظار داریم که بتوان یک مفهوم خوش‌تعریف از \emph{کلاف‌های کرنل} را تدوین کرد که مقاطع آنها در تناظر یک به یک با تعریف ما از میدان‌های کرنل به عنوان نگاشت‌های کلاف باشند (این فرمول‌بندی مجدد، گذار از معادله~\eqref{eq:bundle_morphism_onexone} به معادله~\eqref{eq:hom_bdl_section_unconstrained} را منعکس می‌کند).
}
در عمل، کرنل‌های $\Kp$ اغلب برای تشخیص الگوهای محلی در اطراف $p$ طراحی می‌شوند و بنابراین فرض می‌شود که در اطراف مبدأ $\TpM$ دارای تکیه‌گاه فشرده باشند.

یک کرنل مستقل از مختصات $\Kp$ در $p$ نسبت به پیمانه‌های $\psiTMp^A$ و $\psiHomp^A$ از \lr{G}-اطلس‌ها توسط نگاشت زیر داده می‌شود:
\begin{align}\label{eq:kernel_field_general_coord_expression}
    \Kp^A: \R^d \to \R^{\cout\times\cin}, \qquad
    \Kp^A\: :=\: \psiHomp^A \circ \Kp \circ \big(\psiTMp^A\big)^{-1} \,.
\end{align}
شکل~\ref{fig:kernel_coordinatization} یک کرنل مستقل از مختصات روی $\TpM$ و مختصاتی‌سازی‌های آن روی $\R^d$ را نسبت به پیمانه‌های مختلف به تصویر می‌کشد.
از نمودار جابجایی
\begin{equation}
    \begin{tikzcd}[column sep=45pt, row sep=30, font=\normalsize]
        \R^d    \arrow[rrr, pos=.4, "\Kp^A"]
                \arrow[dd, "g_p^{BA}\cdot"']
        & & &[-5pt]
        \R^{\cout\times\cin}
                \arrow[dd, "\,\rhoHom\big(g_p^{BA}\big)"]
        \\
        &
        \TpM    \arrow[r, "\Kp"]
                \arrow[lu, pos=.4, "\psiTMp^A"']
                \arrow[ld, pos=.4, "\psiTMp^B"]
        &
        \Hom\!\big(\Ain|_p,\Aout|_p\big)
                \arrow[ru, start anchor={[xshift=2.em]}, pos=.4, "\psiHomp^A"]
                \arrow[rd, start anchor={[xshift=2.em]}, pos=.4, "\psiHomp^B"']
        &
        \\
        \R^d    \arrow[rrr, pos=.4, "\Kp^B"']
        & & &
        \R^{\cout\times\cin}
    \end{tikzcd}
\end{equation}
نتیجه می‌شود که مختصاتی‌سازی‌های مختلف کرنل با رابطه زیر به هم مرتبط هستند:
\begin{align}\label{eq:kernel_field_unconstrained_gaugetrafo}
    \Kp^B \ =\ \rhoHom\big(g_p^{BA}\big) \circ \Kp^A \circ \big(g_p^{BA}\big)^{-1} \,.
\end{align}
توجه داشته باشید که این رابطه فقط استقلال از مختصات $\GM$ را ایجاب می‌کند اما کرنل مستقل از مختصات را به هیچ وجه محدود نمی‌کند.
مانند قبل، وضعیت با اشتراک‌گذاری وزن‌ها در موقعیت‌های مکانی تغییر می‌کند.


برای اینکه یک میدان کرنل $\KK$ متناظر با یک کانولوشن باشد، باید به طور کامل توسط یک کرنل الگوی واحد $K: \R^d \to \R^{\cout\times\cin}$ مشخص شود که در تمام موقعیت‌های مکانی به اشتراک گذاشته شده است.
ما دوباره مجبوریم وزن‌ها را با تمام پیمانه‌های $X \in \mathfrak{X}$ به طور همزمان به اشتراک بگذاریم تا هم‌ارزی آنها و در نتیجه استقلال از مختصات $\GM$ را حفظ کنیم.
همانطور که در بخش~\ref{sec:gauge_conv} استدلال شد، روش مناسب برای اشتراک‌گذاری $K$ با مختصاتی‌سازی‌های کرنل $\KKp^X$ شامل نرمال‌سازی با حجم قاب مرجع $\sqrt{|\eta_p^X|}$ است و به صورت زیر تعریف می‌شود:
\begin{align}\label{eq:weight_sharing_kernel_62}
    \KKp^X\ =\ \frac{K}{\sqrt{|\eta_p^X|}}
    \qquad \textup{برای \emph{هر} پیمانه}\,\ X \in \mathfrak{X}\,\ \textup{با}\,\ p\in U^X \,.
\end{align}
دلیل وجود ضریب نرمال‌سازی قاب این است که کانولوشن‌ها بعداً بر حسب انتگرال روی فضاهای مماس تعریف خواهند شد.
بنابراین ما در واقع ملزم به اشتراک‌گذاری خود عملگر انتگرال در مختصاتی‌سازی‌های مختلف هستیم،
که معادل با شناسایی معیارهای انتگرال‌گیری ماتریسی $\KKp^X(\mathscr{v})\, \sqrt{|\eta_p^X|}\; d\mathscr{v}$ برای هر پیمانه $X \in \mathfrak{X}$ در $p\in M$ با یک معیار الگو $K(\mathscr{v})\, d\mathscr{v}$ است.
شکل اشتراک‌گذاری کرنل در معادله~\eqref{eq:weight_sharing_kernel_62} با برابر قرار دادن هر دو عبارت به دست می‌آید.


همراه با رابطه $\sqrt{|\eta_p^A|} = \big|\!\det(g_p^{BA})\big| \mkern1.5mu \sqrt{|\eta_p^B|}$ بین حجم‌های قاب مختلف، قانون تبدیل کرنل در معادله~\eqref{eq:kernel_field_unconstrained_gaugetrafo} و اشتراک‌گذاری وزن در معادله~\eqref{eq:weight_sharing_kernel_62} \emph{قید کرنل \lr{G}-هدایت‌پذیر} را ایجاب می‌کند:
\begin{align}\label{eq:kernel_constraint_rhohom}
    \frac{1}{\detg} \, \rhoHom(g) \circ K \circ g^{-1}\ =\ K \qquad\forall\: g\in G \,.
\end{align}
بنابراین کرنل‌های الگوی معتبر توسط نامتغیرهای تحت عمل پیمانه همزمان $\detg^{-1}$، $\rhoHom(g)$ و $g^{-1}$ داده می‌شوند.
با نوشتن نمایش $\rhoHom$ که بر روی $\R^{\cout\times\cin}$ از طریق ضرب با $\rhoout$ و $\rhoin^{-1}$ به ترتیب از چپ و راست عمل می‌کند، دیده می‌شود که قید در معادله~\eqref{eq:kernel_constraint_rhohom} معادل با قید در معادله~\eqref{eq:kernel_constraint} است، یعنی
$K(g\mkern1mu\mathscr{v}) = \detg^{-1} \rho_\text{\lr{out}}(g)\, K(\mathscr{v})\, \rho_\text{\lr{in}}(g)^{-1} \ \ \forall\, g\in G,\ \mathscr{v}\in\R^d$.

ما این بینش‌ها را در قالب تعاریف زیر بیان می‌کنیم:
\begin{dfn}[کرنل \lr{G}-هدایت‌پذیر]
\label{dfn:G-steerable_kernel_def_43}
    کرنل‌های \lr{G}-هدایت‌پذیر با \emph{نامتغیر بودنشان تحت عمل پیمانه} مشخص می‌شوند.
    فضای برداری کرنل‌های هموار \lr{G}-هدایت‌پذیر که بین انواع میدان $\rhoin$ و $\rhoout$ نگاشت می‌کنند، به صورت زیر تعریف می‌شود:
    \begin{align}
        \KG \!:=&\,
        \Big\{ K\!: \R^d \to \R^{\cout\times\cin}\ \text{هموار} \,\Big|\,
        \frac{1}{\detg}\, \rhoHom(g) \circ K \circ g^{-1} =\, K \ \ \ \forall g\in G \Big\} \,,
        \label{eq:G_steerable_space_in_dfn_Hom} \\[1ex]
        =&\ 
        \Big\{ K\!: \R^d \to \R^{\cout\times\cin}\ \text{هموار} \,\Big|\,
        \frac{1}{\detg}\mkern1mu \rhoout(g) K(g^{-1}\mathscr{v}) \rhoin(g)^{-1} \mkern-2mu= K(\mathscr{v}) \ \ \ \forall\, g\in G,\ \mathscr{v} \in \R^d \Big\} ,
        \label{eq:G_steerable_space_in_dfn_classical}
    \end{align}
    که در آن $\rhoHom(g)H := \rhoout(g)H \rhoin(g)^{-1}$ برای هر $H\in \R^{\cout\times\cin}$ و $G\leq\GL{d}$ است.
    نامتغیر بودن پیمانه‌ای کرنل‌های \lr{G}-هدایت‌پذیر امکان اشتراک‌گذاری وزن مستقل از مختصات $\GM$ را فراهم می‌کند.
\end{dfn}
کرنل‌های \lr{G}-هدایت‌پذیر در~\cite{Cohen2017-STEER} به یادگیری عمیق هم‌متغیر معرفی شدند، جایی که گروه‌های متناهی فرض شده بودند.
فرمول‌بندی فعلی در تعریف~\ref{dfn:G-steerable_kernel_def_43} در~\cite{3d_steerableCNNs} پیشنهاد شد.
یک راه حل کامل برای فضاهای کرنل \lr{G}-هدایت‌پذیر برای نمایش‌های دلخواه $\rhoin$ و $\rhoout$ از گروه‌های ساختار $G\leq\OO2$ در~\cite{Weiler2019_E2CNN} استخراج شده است، یک پیاده‌سازی به صورت عمومی در \url{https://quva-lab.github.io/e2cnn/api/e2cnn.kernels.html} در دسترس است.
از نظر ریاضی، کرنل‌های هدایت‌پذیر معادل با \emph{عملگرهای نمایشی} مانند عملگرهای تانسور کروی از مکانیک کوانتومی هستند.
یک تعمیم از \emph{قضیه ویگنر-اکارت} کرنل‌های \lr{G}-هدایت‌پذیر را به عنوان ترکیبی از توابع پایه هارمونیک، ضرایب کلبش-گوردان و اندومورفیسم‌های نمایش‌های کاهش‌ناپذیر توصیف می‌کند~\cite{lang2020WignerEckart}.



\begin{dfn}[میدان کرنل کانولوشنی $\GM$]
\label{dfn:conv_kernel_field}
    یک \emph{میدان کرنل کانولوشنی $\GM$} $\KK$ از نوع $\rhoin,\rhoout$ یک میدان کرنل است که توسط یک کرنل الگوی \emph{\lr{G}-هدایت‌پذیر} و مشترک $K \in \KG$ تعیین می‌شود.
    این میدان در \emph{پیمانه‌های دلخواه} $\psiTMp^X$ و $\psiHomp^X\,$ از \lr{G}-اطلس مورد نظر به صورت نقطه‌ای تعریف می‌شود:
    \begin{align}\label{eq:conv_kernel_field_def_ptwise}
        \KKp \,:=\ \big(\psiHomp^X\big)^{\mkern-2mu-1} \circ \frac{K}{\sqrt{|\eta_p^X|}} \circ \psiTMp^X
    \end{align}
    همواری $\KK$ از همواری پیمانه‌ها، متریک و کرنل الگو ناشی می‌شود.
\end{dfn}
همانند مورد \onexoneGMsfarsi، اختیاری بودن انتخاب خاص پیمانه در معادله~\eqref{eq:conv_kernel_field_def_ptwise} -- و بنابراین استقلال از مختصات $\GM$ تعریف -- با \lr{G}-هدایت‌پذیری $K\in\KG\!$ تضمین می‌شود.
برای نشان دادن این موضوع به طور صریح، می‌توان میدان کرنل را نسبت به یک پیمانه $B$ تعریف کرد و سپس یک تبدیل به هر پیمانه دیگر $A$ اعمال کرد، که حذف می‌شود و بنابراین به یک عبارت معادل منجر می‌شود:
\begin{align}\label{eq:arbitrariness_gauge_GM_kernel_field_def}
    \KKp
    \,\ =&\,\ \big(\psiHomp^B \big)^{-1} \,\circ \,\frac{K}{\sqrt{|\eta^B|}} \circ \psiTMp^B \notag \\
    \,\ =&\,\ \big( \rhoHom\big(g_p^{BA}\big)\, \psiHomp^A \big)^{-1} \,\circ \,\frac{K}{\sqrt{|\eta^A|} \,/\, |\! \det(g_p^{BA})| } \circ \big( g_p^{BA}\cdot \psiTMp^A \big) \notag \\
    \,\ =&\,\ \big(\psiHomp^A \big)^{-1} \,\circ \frac{\,\big|\! \det(g_p^{BA})\big|\, \rhoHom\big(g_p^{BA}\big)^{-1} \circ K \circ g_p^{BA}}{\sqrt{|\eta^A|}} \circ \psiTMp^A \notag \\
    \,\ =&\,\ \big(\psiHomp^A \big)^{-1} \,\circ \,\frac{K}{\sqrt{|\eta^A|}} \circ \psiTMp^A
\end{align}
شکل~\ref{fig:triv_kernel_bundle_morphism} یک نمای کلی از بدیهی‌سازی‌های محلی میدان‌های کرنل کانولوشنی $\GM$ را در قالب یک نمودار جابجایی ارائه می‌دهد.

\begin{figure}
    \centering
    \begin{tikzcd}[row sep=4.5em, column sep=5.2em]
        % ROW 1
          U\times\R^d
                        \arrow[rrrr, pos=.48, rounded corners, to path={ 
                                -- ([yshift=2.5ex]\tikztostart.north) 
                                --node[above]{\small$
                                    \KK^B = \big(\id\times K/\mkern-2mu \sqrt{|\eta^B|} \,\big)
                                $} ([yshift=2.5ex]\tikztotarget.north) 
                                -- (\tikztotarget.north)
                                }]
        & &[-3.25em] &[-3.25em] &
        U\times\R^{c_\text{out}\times c_\text{in}}
        \\
        % ROW 2
        U\times\R^d
                        \arrow[u, "\big(\id\times g^{BA}\!\!\cdot\big)"]
                        \arrow[rrd, "\proj_1"']
                        \arrow[rrrr, pos=.5, rounded corners, to path={ 
                                -- ([yshift=-16.ex]\tikztostart.south) 
                                --node[below]{\small$
                                    \KK^A = \big(\id\times K/\mkern-2mu \sqrt{|\eta^A|} \,\big)
                                $} ([yshift=-16.ex]\tikztotarget.south) 
                                -- (\tikztotarget.south)
                                }]
        &
        \piTM^{-1}(U)   
                        \arrow[rd, "\piTM\!\!"', pos=0.3]
                        \arrow[rr, "\KK"]
                        \arrow[lu, "\PsiTM^B"']
                        \arrow[l,  "\PsiTM^A"']
        & &
        \piHom^{-1}(U)
                        \arrow[ld, "\!\piHom", pos=0.3]
                        \arrow[r,  "\PsiHom^A"]
                        \arrow[ru, "\PsiHom^B"]
        &
        U\times\R^{c_\text{out}\times c_\text{in}}
                        \arrow[u, "\big(\id\times \rhoHom\big(g^{BA}\big)\!\cdot\big)"']
        \arrow[lld, "\proj_1"] \\
        % ROW 3
        & &
        U
        & &
    \end{tikzcd}
    \caption{\small
        نمودار جابجایی که بدیهی‌سازی‌های محلی یک \emph{میدان کرنل کانولوشنی} $\GM$ یعنی $\KK$ را همانطور که در تعریف~\ref{dfn:conv_kernel_field} تعریف شده است، نشان می‌دهد.
        اشتراک‌گذاری وزن کانولوشنی مستلزم آن است که عبارت مختصاتی میدان کرنل $\KK$ در هر نقطه $p\in M$ و هر پیمانه $X$ در $p$ توسط کرنل الگوی مشترک ${K: \R^d \to \R^{\cout\times\cin}}$ به صورت
         $\KKp^X = K/\sqrt{|\eta_p^X|}$ تعیین شود.
        جابجایی‌پذیری نمودار سپس قید \lr{G}-هدایت‌پذیری ${\detg^{-1} \rhoHom(g) \circ K \circ g^{-1} = K} \ \ \forall g\in G$ را بر روی فضای $\KG$ از کرنل‌های الگو ایجاب می‌کند.
        ما می‌خواهیم تأکید کنیم که، با وجود شباهت به نمودار در شکل~\ref{fig:triv_bundle_morphism_onexone}، نمودار در این شکل باید به عنوان مشابه نمودار در شکل~\ref{fig:trivialization_hom_onexone_section} دیده شود.
        تفاوت بین نمودار فعلی و نمودار در شکل~\ref{fig:trivialization_hom_onexone_section} این است که نگاشت‌های خطی در کلاف هومومورفیسم از طریق $\KK: \TM\to \Hom(\Ain,\Aout)$ توسط یک عنصر از کلاف مماس $\TM$ به جای مقطع $\sigma_{K_{1\!\times\!1}}: M\to \Hom(\Ain,\Aout)$ تعیین می‌شوند.
    }
    \label{fig:triv_kernel_bundle_morphism}
\end{figure}


توجه داشته باشید که قید \lr{G}-هدایت‌پذیری در معادله~\eqref{eq:G_steerable_space_in_dfn_classical} یا~\eqref{eq:G_steerable_space_in_dfn_Hom} هنگام ارزیابی در مبدأ $\mathscr{v}=0$ از $\R^d$ که تحت عمل هر $g\in G$ نامتغیر است، به قید روی کرنل‌های \onexoneGMfarsi\ در معادله~\eqref{eq:onexone_kernel_constraint} یا~\eqref{eq:onexone_intertwiner_constraint_rhoHom} کاهش می‌یابد.
بنابراین، نتایج مربوط به \onexoneGMsfarsi که در بخش قبل استخراج شدند، به عنوان یک مورد خاص برای انتخاب کرنل‌های نقطه‌مانند دیده می‌شوند.%
\footnote{
    برای دقیق کردن این گزاره، باید تعریف~\ref{dfn:G-steerable_kernel_def_43} را به توزیع‌های با مقدار عملگری تعمیم داد و کرنل‌های \onexoneGMfarsi\ را به عنوان دلتاهای دیراک با مقدار عملگری تعریف کرد.
    ما در اینجا برای اختصار از این تعمیم صرف نظر می‌کنیم.
}
ما همچنین می‌خواهیم ذکر کنیم که قید روی کرنل‌های با گستره فضایی به طور کلی نیازی ندارد که هم‌دامنه آنها به $\Hom_G(\rhoin,\rhoout)$، یعنی فضای درهم‌تننده‌ها، محدود شود.
برخلاف \onexoneGMsfarsi، این به کانولوشن‌های $\GM$ با کرنل‌های با گستره فضایی اجازه می‌دهد تا بین میدان‌هایی که طبق نمایش‌های کاهش‌ناپذیر غیرایزومورف تبدیل می‌شوند، نگاشت انجام دهند.










\subsubsection{تبدیلات میدان کرنل و کانولوشن‌های \lr{GM}}
\label{sec:KFTs_GM-conv_global}

با تعریف هر دو میدان ویژگی و میدان کرنل، آماده معرفی تبدیلات میدان کرنل و کانولوشن‌های $\GM$ هستیم.
آنها به صورت نقطه‌ای بر حسب عملگرهای انتگرالی تعریف می‌شوند که بردارهای ویژگی خروجی $\fout(p)$ را در نقاط $p\in M$ با تطبیق کرنل $\Kp$ در $p$ با میدان ویژگی $\fin$ «همانطور که از $p$ دیده می‌شود» محاسبه می‌کنند.

نمایش محلی یک میدان ورودی «همانطور که از $p$ دیده می‌شود» به طور رسمی توسط \emph{پول‌بک منتقل‌کننده} آن داده می‌شود که در شکل~\ref{fig:pullback_field_exp_TpM} به تصویر کشیده شده است.
این به عنوان پول‌بک معمول از $M$ به $\TM$ از طریق نگاشت نمایی ریمانی تعریف می‌شود%
\footnote{
    ما نگاشت نمایی را روی کل کلاف مماس به صورت
    $\exp: \TM \!\to M,\ \ v \mapsto \exp_{\scalebox{.85}{$\pi_{\overset{}{\protect\scalebox{.6}{$T\mkern-2muM$}}}\mkern-1mu(v)$}}(v)$ تعریف می‌کنیم.
    به یاد بیاورید که ما فرض کردیم منیفلد از نظر ژئودزیکی کامل است، به طوری که نگاشت نمایی روی کل کلاف مماس خوش‌تعریف است (و اگر این فرض برقرار نباشد به صفر-پوشانی متوسل می‌شویم).
}
با کاربرد اضافی یک منتقل‌کننده موازی (معادله~\eqref{eq:transporter_A_def})، که برای بیان ویژگی‌های پول‌بک شده در $\mathcal{A}_{\textup{in},\exp(v)}$ به عنوان ویژگی در $\Ainp$ ضروری است.
با نشان دادن این منتقل‌کننده موازی در امتداد مسیر ژئودزیک $\gamma_v(t) := \exp((1-t) \,v)$ بین $\gamma(0) = \exp(v)$ و $\gamma(1) = \pi(v) =: p$ با
\begin{align}
    \mathcal{P}_{\mkern-4mu\overset{}{\protect\scalebox{.75}{$\!\A$},\protect\scalebox{.75}{$\, p\!\leftarrow\!\exp(v)$}}}
    : \A_{\exp(v)} \to \A_p \,,
\end{align}
ما نمایش‌های میدان ویژگی پول‌بک شده را روی فضاهای مماس به صورت زیر تعریف می‌کنیم:
\begin{dfn}[پول‌بک منتقل‌کننده میدان ویژگی به \lr{TM}]
\label{dfn:Expf_pullback_field}
    با داشتن یک میدان ویژگی $f \in \Gamma(\A)$، ما نمایش (زائد) آن را روی کلاف مماس به صورت زیر تعریف می‌کنیم:
    \begin{align}
        \Expsf :\ \TM \to \A, \quad\ 
        v \,\mapsto\, \PAexpv \!\circ f \circ \exp(v) \,.
    \end{align}
    نگاشت نمایی ریمانی $\exp$ در اینجا متناظر با اتصال لوی-چیویتا است، در حالی که منتقل‌کننده $\PAexpv$ به یک اتصال \lr{G}-سازگار متکی است؛ به بخش‌های~\ref{sec:transport_local} و~\ref{sec:bundle_transport} مراجعه کنید.

    از ساختار مشخص است که $\Expsf(v) \in \A_p\,$ برای هر $v \in \TpM$، یعنی $\Expsf$ یک \lr{M}-مورفیسم کلاف است که نمودار جابجایی زیر را برآورده می‌کند:
    \begin{equation}\label{eq:pullback_field_bundle_map}
        \begin{tikzcd}[row sep=3.5em, column sep=2.5em]
            % ROW 1
            \TM  \arrow[rd, start anchor={[xshift=.6ex]}, "\piTM"']
                \arrow[rr, "\Expsf"]
            & &
            \mkern-3mu
            \A
                \arrow[ld, "\piA"] \\
            % ROW 2
            & M &
        \end{tikzcd}
    \end{equation}
    با وجود نگاشت هموار بین دو کلاف برداری، فرض نمی‌شود که $\Expsf$ یک مورفیسم \emph{کلاف برداری} باشد، یعنی، محدودیت‌های $\Expspf: \TpM \to \A_p$ معمولاً خطی نیستند.
\end{dfn}
محدودیت $\Expspf := \Expsf\big|_{\TpM}$ دامنه پول‌بک منتقل‌کننده به $\TpM$ میدان ویژگی را از دیدگاه یک ناظر در $p$ همانطور که در شکل~\ref{fig:pullback_field_exp_TpM} نشان داده شده است، ثبت می‌کند.
توجه داشته باشید که این تعریف شبیه به یک نمایش محلی از میدان ویژگی بر حسب \emph{مختصات نرمال ژئودزیک} است، با این تفاوت که به شعاع یکنوایی نگاشت نمایی محدود نمی‌شود.%
\footnote{
    بنابراین هر بردار ویژگی $f(q)$ ممکن است چندین بار در همان فضای مماس $\TpM$ نمایش داده شود، یک بار برای هر $v\in\TpM$ با $\exp(v)=q$.
    اگر این مطلوب نباشد، می‌توان تکیه‌گاه کرنل را به شعاع یکنوایی نگاشت نمایی محدود کرد، به طوری که فقط نزدیکترین رخداد از نظر ژئودزیکی اندازه‌گیری شود.
}
ما همچنین می‌خواهیم ذکر کنیم که منتقل‌کننده ممکن است با هر ایزومورفیسم دیگری بین $\A_{\exp(v)}$ و $\A_p$ جایگزین شود، همانطور که به عنوان مثال در~\cite{sommer2019horizontal} انجام شده است.


همانطور که قبلاً بیان شد، تبدیلات میدان کرنل و کانولوشن‌های $\GM$ به عنوان تطبیق نمایش‌های میدان ویژگی محلی روی فضاهای مماس با کرنل‌ها تعریف می‌شوند.
در راستای این تعاریف، توجه داشته باشید که \lr{M}-مورفیسم‌های کلاف کرنل‌ها $\K: \TM \to \Hom(\Ain,\Aout)$ و نمایش‌های میدان محلی $\Expsfin: \TM \to \Ain$ را می‌توان برای ایجاد یک \lr{M}-مورفیسم (غیرخطی) دیگر از $\TM$ به $\Aout$ ترکیب کرد،
\begin{equation}\label{eq:integrand_bundle_map}
    \quad
    \begin{tikzcd}[row sep=3.5em, column sep=6.5em]
        % ROW 1
        \TM  \arrow[rd, start anchor={[xshift=-1ex]}, "\piTM"']
            \arrow[r, "\K \mkern-1mu\times\mkern-1mu \Expsfin"]
        &
        \mkern-3mu
        \Hom(\Ain,\Aout) \!\times\! \Ain
            \arrow[r, "\ev"]
        &
        \Aout
            \arrow[ld, "\piAout"] \\
        % ROW 2
        & M &
    \end{tikzcd}
    \quad,
\end{equation}
که در آن $\ev: \big(\K(v),\, \Expsfin(v)\big) \mapsto \K(v) \Expsfin(v)$ نگاشت ارزیابی روی $\Hom(\Ain,\Aout) \!\times\! \Ain$ است.
تبدیلات میدان کرنل بردارهای ویژگی خروجی را در $p$ با انتگرال‌گیری از این حاصلضرب کرنل‌ها و میدان‌های ورودی روی فضای مماس مربوطه $\TpM$ محاسبه می‌کنند:
\begin{dfn}[تبدیل میدان کرنل]
\label{dfn:kernel_field_trafo}
    فرض کنید $\K$ هر میدان کرنل همواری باشد.
    \emph{تبدیل میدان کرنل} متناظر، یک تبدیل انتگرالی هموار است
    \begin{align}\label{eq:kernel_field_trafo_def_signature}
        \TK: \Gamma(\Ain)\to \Gamma(\Aout)
    \end{align}
    که به صورت نقطه‌ای تعریف می‌شود:%
    \footnote{
        انتگرال‌گیری روی $\TpM$ از طریق چگالی حجم ریمانی $dv$ در پیوست~\ref{apx:tangent_integral} بحث شده است.
    }
    \begin{align}\label{eq:kernel_field_trafo_def_ptwise}
        \big[ \TK (\fin)\big] (p)
        \,\ :=\, \int\limits_{\TpM}\!\!
            \K(v) \,
            \Expsfin (v)
            \ dv
        \,\ =\, \int\limits_{\TpM}\!\!
            \K(v) \ 
            \PAinexppv \; \fin(\exp_p\!v)
            \ dv \,.
    \end{align}
    برای خوش‌تعریف بودن، انتگرال باید وجود داشته باشد و میدان خروجی حاصل $\TK(f)$ باید هموار باشد.
    این مستلزم آن است که $\K$ به طور مناسب انتخاب شود، به عنوان مثال، با فرض اینکه به سرعت کاهش یابد یا دارای تکیه‌گاه فشرده باشد.
\end{dfn}
توجه داشته باشید که تبدیلات میدان کرنل عمومی لزوماً کانولوشن‌ها را مدل نمی‌کنند زیرا فرض نمی‌کنند که وزن‌ها (کرنل‌ها) بین موقعیت‌های مکانی به اشتراک گذاشته شوند.
چنین تبدیلات میدان کرنل عمومی در بخش~\ref{sec:isometry_intro} مفید خواهند بود، جایی که ما یک الزام برای اشتراک‌گذاری وزن مکانی را از الزام به هم‌متغیری ایزومتریک استخراج می‌کنیم.


پیوست~\ref{apx:smoothness_kernel_field_trafo} وجود و همواری تبدیلات میدان کرنل را مورد بحث قرار می‌دهد.
یک شرط کافی برای خوش‌تعریف بودن تبدیلات میدان کرنل، محدود کردن تکیه‌گاه‌های کرنل به گوی‌هایی با شعاع ثابت $R>0$ است:
\begin{thm}[وجود تبدیل میدان کرنل برای کرنل‌های با تکیه‌گاه فشرده]
\label{thm:existence_kernel_field_trafo_compact_kernels}
    فرض کنید $\K$ یک میدان کرنل باشد که کرنل‌های منفرد آن $\Kp$ در هر $p\in M$ (حداکثر) روی یک گوی بسته با شعاع $R>0$ در اطراف مبدأ $\TpM$ تکیه‌گاه دارند، یعنی،
    \begin{align}
        \supp\!\big(\Kp\big)\ \subseteq\ \big\{ v\in\TpM \,\big|\, \lVert v\rVert \leq R \big\} \quad \forall p\in M \,.
    \end{align}
    سپس تضمین می‌شود که تبدیل میدان کرنل متناظر $\TK$ خوش‌تعریف است، یعنی انتگرال در معادله~\eqref{eq:kernel_field_trafo_def_ptwise} وجود دارد و میدان خروجی $\TK(f) \in \Gamma(\Aout)$ برای هر میدان ورودی هموار $f\in\Gamma(\Ain)$ هموار است.
\end{thm}
\begin{proof}
    به پیوست‌های~\ref{apx:smoothness_kernel_field_trafo} و~\ref{apx:proof_sufficiency_ball_kernel_support} مراجعه کنید.
\end{proof}
الزام به محدود کردن تکیه‌گاه کرنل به یک گوی بسته با شعاع معین، یک رویه معمول در یادگیری عمیق است.
با این حال، توجه داشته باشید که یک کرنل با تکیه‌گاه فشرده با کانولوشن‌های هم‌متغیر نسبت به مقیاس در تضاد است، که طبق قیود کرنل \lr{G}-هدایت‌پذیر مربوطه، به کرنل‌هایی با گستره بی‌نهایت نیاز دارند.
پیاده‌سازی‌های فعلی کانولوشن‌های هم‌متغیر نسبت به مقیاس معمولاً فضاهای کرنل هم‌متغیر نسبت به مقیاس را با محدود کردن تکیه‌گاه آنها تقریب می‌زنند~\cite{marcos2018scale,Worrall2019DeepScaleSpaces,ghosh2019scale,zhu2019scale,bekkers2020bspline,Sosnovik2020scale,naderi2020scalesteerable} و بنابراین تحت پوشش قضیه~\ref{thm:existence_kernel_field_trafo_compact_kernels} قرار می‌گیرند.


بر اساس تبدیلات میدان کرنل عمومی، ما \emph{کانولوشن‌های $\GM$ مستقل از مختصات} را با افزودن فرض اشتراک‌گذاری وزن مکانی تعریف می‌کنیم، یعنی با فرض \emph{میدان‌های کرنل کانولوشنی} $\GM$:
\begin{dfn}[کانولوشن $\GM$]
\label{dfn:coord_free_conv}
    فرض کنید $\Ain$ و $\Aout$ کلاف‌های بردار ویژگی \lr{G}-الحاقی با انواع $\rhoin$ و $\rhoout$ باشند.
    ما \emph{کانولوشن $\GM$} را با یک کرنل \lr{G}-هدایت‌پذیر $K\in\KG$ به عنوان تبدیل میدان کرنل با \emph{میدان کرنل کانولوشنی} $\GM$ متناظر $\KK$ تعریف می‌کنیم:
    \begin{align}\label{eq:coord_free_conv_def_signature}
        K\,\star\,:\, \Gamma(\Ain)\to \Gamma(\Aout), \quad
        \fin \mapsto K\star \fin \,:=\, \TKK(\fin)
        \,=\! \int\limits_{\TpM}\! \KK(v)\ \Expsfin(v)\ dv
    \end{align}
\end{dfn}
از آنجایی که کانولوشن‌های $\GM$ هیچ قاب مرجعی را در \lr{G}-ساختار ترجیح نمی‌دهند، تضمین می‌شود که استنتاج خود را بر روی تمام «وضعیت‌های» الگوهایی که با عمل گروه ساختار $G$ مرتبط هستند، تعمیم دهند؛ به معادله~\eqref{eq:active_local_gauge_trafo} و شکل~\ref{fig:active_TpM_equivariance} مراجعه کنید.












\subsubsection{تبدیلات میدان کرنل و کانولوشن‌های \lr{GM} در مختصات محلی}
\label{sec:KFTs_GM-conv_local}

آنچه باقی مانده است این است که نشان دهیم تعاریف مستقل از مختصات پول‌بک‌های منتقل‌کننده، تبدیلات میدان کرنل و کانولوشن‌های $\GM$ که در این بخش معرفی شدند، هنگام بیان نسبت به یک بدیهی‌سازی محلی، به عبارات مختصاتی از بخش~\ref{sec:gauge_conv_main} کاهش می‌یابند.

عبارت مختصاتی محلی پول‌بک منتقل‌کننده $\Expsf$ از یک میدان ویژگی $f$، طبق معمول، با پیش- و پس-ترکیب آن با بدیهی‌سازی‌های محلی کلاف‌های متناظر تعریف می‌شود، یعنی:
\begin{align}\label{eq:kft_coordinate_expression_62}
    \big[\Expsf \big]^A: U\times \R^d \to U\times \R^c,\ \ \ 
    (p,\mathscr{v}) \mapsto&\phantom{=} \PsiA^A \circ \Expsf \circ \big(\PsiTM^A \big)^{-1} (p, \mathscr{v}) \notag \\
                             &= \pig(p,\,\ \psiAp^A \circ \Expspf \circ \big(\psiTMp^A \big)^{-1} (\mathscr{v}) \pig)
\end{align}
از این تعریف دیده می‌شود که تبدیلات پیمانه محلی در $p\in M$ به صورت زیر داده می‌شوند:
\begin{align}
    \big[\Expspf \big]^B \ =\ \rho\big( g_p^{BA}\big) \circ \big[\Expspf \big]^A \circ \big(g_p^{BA}\big)^{-1} \,.
\end{align}
ما این عبارات مختصاتی را در قالب یک نمودار جابجایی به تصویر می‌کشیم، که بسیار شبیه به نمودار بدیهی‌سازی‌های محلی میدان‌های کرنل در شکل~\ref{fig:triv_kernel_bundle_morphism} است:
\begin{equation}
\begin{tikzcd}[row sep=4.5em, column sep=5.2em]
    % ROW 1
      U\times\R^d
                        \arrow[rrrr, pos=.48, rounded corners, to path={ 
                                -- ([yshift=2.5ex]\tikztostart.north) 
                                --node[above]{\small$
                                    \big[\Expsf \big]^B
                                $} ([yshift=2.5ex]\tikztotarget.north) 
                                -- (\tikztotarget.north)
                                }]
    & &[-3.25em] &[-3.25em] &
    U\times\R^c
    \\
    % ROW 2
    U\times\R^d
                        \arrow[u, "\big(\id\times g^{BA}\!\!\cdot\big)"]
                        \arrow[rrd, "\proj_1"']
                        \arrow[rrrr, pos=.5, rounded corners, to path={ 
                                -- ([yshift=-16.ex]\tikztostart.south) 
                                --node[below]{\small$
                                    \big[\Expsf \big]^A
                                $} ([yshift=-16.ex]\tikztotarget.south) 
                                -- (\tikztotarget.south)
                                }]
    &
    \piTM^{-1}(U)   
                        \arrow[rd, "\piTM\!\!"', pos=0.3]
                        \arrow[rr, "\Expsf"]
                        \arrow[lu, "\PsiTM^B"']
                        \arrow[l,  "\PsiTM^A"']
    & &
    \piA^{-1}(U)
                        \arrow[ld, "\!\piA", pos=0.3]
                        \arrow[r,  "\PsiA^A"]
                        \arrow[ru, "\PsiA^B"]
    &
    U\times\R^c
                        \arrow[u, "\big(\id\times \rho\big(g^{BA}\big)\!\cdot\big)"']
    \arrow[lld, "\proj_1"] \\
    % ROW 3
    & &
    U
    & &
\end{tikzcd}
\end{equation}

برای پیاده‌سازی، مفید است که عبارت مختصاتی پول‌بک منتقل‌کننده را به اجزای منفرد آن، یعنی منتقل‌کننده
$\mathcal{P}_{\mkern-4mu\overset{}{\protect\scalebox{.75}{$\!\A$},\protect\scalebox{.75}{$\, p\!\leftarrow\!\exp(v)$}}}$،
میدان ویژگی $f$ و نگاشت نمایی $\exp$، تجزیه کنیم.
این کار با بسط دادن آن با یک همانی به شکل
$\id_{\A_{\exp(v)}} = \big(\psiAexpnop^{\widetilde{A}} \big)^{-1} \circ \psiAexpnop^{\widetilde{A}}$
انجام می‌شود، که در آن انتخاب پیمانه $\widetilde{A}$ در $\exp(v)$ بی‌اهمیت است زیرا در نهایت حذف می‌شود:
\begin{align}\label{eq:coordinate_expression_transporter_pullback_62}
    \big[\Expspf \big]^A (\mathscr{v})
    \ &=\ \pig[ \psiAp^A \circ \Expspf \circ \big(\psiTMp^A \big)^{-1} \pig] (\mathscr{v}) \notag \\
    \ &=\ \psiAp^A \circ 
        \mathcal{P}_{\mkern-4mu\overset{}{\protect\scalebox{.75}{$\!\A$},\protect\scalebox{.75}{$\, p\!\leftarrow\!\exp(v)$}}}
     \circ f \big( \exp \circ \big(\psiTMp^A\big)^{-1} (\mathscr{v})\big) \notag \\
    \ &=\ \psiAp^A \circ 
        \mathcal{P}_{\mkern-4mu\overset{}{\protect\scalebox{.75}{$\!\A$},\protect\scalebox{.75}{$\, p\!\leftarrow\!\exp(v)$}}}
     \circ \big(\psiAexpnop^{\widetilde{A}_v} \big)^{-1} \circ \psiAexpnop^{\widetilde{A}_v}
     \circ f \big( \exp \circ \big(\psiTMp^A\big)^{-1} (\mathscr{v})\big) \notag \\
    \ &=\ \rho\pig( g^{A\widetilde{A}}_{p\leftarrow\exp\circ (\psiTMp^A)^{-1}(\mathscr{v})} \pig) \mkern1mu
     \cdot f^{\widetilde{A}} \big( \exp \circ \big(\psiTMp^A\big)^{-1} (\mathscr{v})\big) \notag \\
\end{align}
همانطور که انتظار می‌رفت، ما تعریف خود را از معادله~\eqref{eq:transporter_pullback_in_coords} در بخش~\ref{sec:observers_view} بازیابی می‌کنیم، که تأیید می‌کند تعریف~\ref{dfn:Expf_pullback_field} در واقع همتای مستقل از مختصات آن است.


عبارت مختصاتی یک تبدیل میدان کرنل، که با معادله~\eqref{eq:kft_coord_expression} در بخش~\ref{sec:observers_view} منطبق است، توسط قضیه زیر داده می‌شود:
\begin{thm}[تبدیل میدان کرنل در مختصات]
\label{thm:kernel_field_trafo_in_coords}
    نسبت به یک پیمانه $A$ در $p\in U^A$، تبدیل میدان کرنل با عبارت مختصاتی زیر داده می‌شود:
    \begin{align}\label{eq:kernel_field_trafo_in_coords}
        \!\big[ \TK(\fin) \big]^A (p)
        \ &=
        \int\limits_{\R^d}
        \Kp^A (v^A) \ 
        \big[\Expspfin\big]^A (v^A)
        \ \sqrt{|\eta_p^A|}\,\ dv^A
        \notag \\
        \ &=
        \int\limits_{\R^d}
        \Kp^A (v^A) \ 
        \rho\pig( g^{A\widetilde{A}}_{p\leftarrow\exp\circ (\psiTMp^A)^{-1}(v^A)} \pig)
         \cdot \fin^{\widetilde{A}} \big( \exp \circ \big(\psiTMp^A\big)^{-1} (v^A) \big)
        \ \sqrt{|\eta_p^A|}\ dv^A ,\!
    \end{align}
    که در آن پیمانه‌های $\widetilde{A}$ در $\exp(v)$ به طور دلخواه انتخاب می‌شوند زیرا حذف می‌شوند.%
    \footnote{
        توجه داشته باشید که پیمانه‌ها در $\exp(v)$ ممکن است برای $v\in\TpM$ مختلف متفاوت باشند و باید به طور صحیح‌تر با $\widetilde{A}_v$ برچسب‌گذاری شوند.
        ما برای اختصار از این وابستگی چشم‌پوشی می‌کنیم.
    }
\end{thm}
\begin{proof}
    عبارت اول با یک محاسبه ساده که تمام مقادیر درگیر را به عبارات مختصاتی متناظرشان ترجمه می‌کند، استخراج می‌شود:
    \begin{align}
        % ROW 1
        & \ 
            \big[ \TK(\fin) \big]^A (p) \notag \\[.5ex]
        % ROW 2
        \overset{(1)}{=} & \ \ 
            \psiAoutp^A \big[ \TK(\fin) \big] (p) \notag \\[.5ex]
        % ROW 3
        \overset{(2)}{=} & \ \ 
            \psiAoutp^A
            \int\limits_{\TpM}\mkern-4mu
            \Kp(v) \,
            \big[\Expspfin\big] (v)
            \,\ dv
        \notag \\[.5ex]
        % ROW 4
        \overset{(3)}{=} & \ \ 
            \psiAoutp^A
            \int\limits_{\R^d}
            \Kp \pig(\! \big(\psiTMp^A\big)^{-1}(v^A) \pig) \;
            \big[\Expspfin\big] \pig(\!\big( \psiTMp^A \big)^{-1} (v^A) \pig)
            \ \sqrt{|\eta_p^A|}\,\ dv^A
        \notag \\[.5ex]
        % ROW 5
        \overset{(4)}{=} & \ \ 
            \int\limits_{\R^d}
            \Big[ \psiAoutp^A \circ
            \Kp \pig(\! \big(\psiTMp^A\big)^{-1}(v^A) \pig) \circ
            \big( \psiAinp^A \big)^{-1} \Big]
            \Big[ \psiAinp^A \circ
            \big[\Expspfin\big] \circ \big( \psiTMp^A \big)^{-1} \Big] (v^A)
            \ \sqrt{|\eta_p^A|}\,\ dv^A
        \notag \\[.5ex]
        % ROW 6
        \overset{(5)}{=} & \ \ 
            \int\limits_{\R^d}
            \Big[ \psiHomp^A \circ \Kp \circ \big(\psiTMp^A\big)^{-1} \Big] (v^A) \,\ 
            \Big[ \psiAinp^A \circ \big[\Expspfin\big] \circ \big( \psiTMp^A \big)^{-1} \Big] (v^A)
            \,\ \sqrt{|\eta_p^A|}\,\ dv^A
        \notag \\[.5ex]
        % ROW 7
        \overset{(6)}{=} & \ \ 
            \int\limits_{\R^d}
            \Kp^A (v^A) \ 
            \big[\Expspfin\big]^A (v^A)
            \ \sqrt{|\eta_p^A|}\,\ dv^A
    \end{align}
    مرحله (۱) بردار ویژگی خروجی در $p$ را به طور صریح بر حسب پیمانه $\psiAoutp^A$ بیان می‌کند که بر روی تبدیل میدان کرنل مستقل از مختصات عمل می‌کند.
    این عبارت مستقل از مختصات در مرحله (۲) همانطور که در تعریف~\ref{dfn:kernel_field_trafo} تعریف شده است، بسط داده می‌شود.
    مرحله (۳) انتگرال روی $\TpM$ را از طریق پیمانه انتخاب شده به $\R^d$ بازمی‌گرداند، که با جزئیات بیشتر در پیوست~\ref{apx:tangent_integral} توصیف شده است.
    مرحله (۴) یک نگاشت همانی به شکل $\id = \big(\psiAinp^A \big)^{-1} \circ \psiAinp^A$ را وارد می‌کند و $\psiAoutp^A$ را به داخل انتگرال می‌برد
    در حالی که مرحله (۵) تعریف $\psiHomp^A$ را از معادله~\eqref{eq:Hom_bdl_triv_ptwise} شناسایی می‌کند.
    در نهایت، ما عبارات مختصاتی $\Kp$ و $\Expspfin$ را از معادلات~\eqref{eq:kernel_field_general_coord_expression} و~\eqref{eq:kft_coordinate_expression_62} شناسایی می‌کنیم.

    عبارت دوم از عبارت اول با بسط دادن عبارت مختصاتی پول‌بک منتقل‌کننده طبق معادله~\eqref{eq:coordinate_expression_transporter_pullback_62} به دست می‌آید.
\end{proof}



عبارت مختصاتی برای کانولوشن‌های $\GM$ مستقل از مختصات بلافاصله به دست می‌آید:
\begin{thm}[کانولوشن‌های $\GM$ در مختصات]
\label{thm:gauge_equiv_conv_from_coordinate_free}
    یک کانولوشن $\GM$ مستقل از مختصات
    $K\star:\, \Gamma(\Ain) \to \Gamma(\Aout)$
    با یک کرنل \lr{G}-هدایت‌پذیر $K\in\KG$ نسبت به یک پیمانه $A$ در $p\in U^A$ به صورت زیر داده می‌شود:
    \begin{align}
        &\mkern-40mu
        \big[ K\star f \big]^A (p)
        \ =\ \big[ \TKK(f) \big]^A(p)
        \ =\ \int\limits_{\R^d}
            K \mkern-1mu (v^A) \,\ 
            \big[ \Expspf \big]^A (v^A)
            \,\ dv^A \,,
    \end{align}
    یعنی، با عبارت مختصاتی که در معادله~\eqref{eq:gauge_conv_coord_expression} معرفی شد.
    این عبارت ممکن است همانطور که برای تبدیلات میدان کرنل عمومی در معادله~\eqref{eq:kernel_field_trafo_in_coords} انجام شد، بیشتر بسط داده شود.
\end{thm}
\begin{proof}
    نتیجه از قضیه~\ref{thm:kernel_field_trafo_in_coords} با مشاهده اینکه کانولوشن $\GM$ مستقل از مختصات $K\star$ فقط یک تبدیل میدان کرنل با میدان کرنل کانولوشنی $\GM$ متناظر $\KK$ است، به دست می‌آید؛ به تعریف~\ref{dfn:coord_free_conv} مراجعه کنید.
    به طور خاص، عبارت مختصاتی یک میدان کرنل کانولوشنی $\GM$ یعنی $\KK$ طبق تعریف~\ref{dfn:conv_kernel_field} با کرنل \lr{G}-هدایت‌پذیر $K$ نرمال‌شده با حجم قاب داده می‌شود، یعنی $\KKp^A = K/ \sqrt{|\eta_p^A|}$.
    جایگذاری این همانی در معادله~\eqref{eq:kernel_field_trafo_in_coords} به عبارت مختصاتی ادعا شده برای کانولوشن‌های $\GM$ منجر می‌شود.
\end{proof}

این نتیجه اطمینان می‌دهد که یک کانولوشن $\GM$ سراسری و مستقل از مختصات می‌تواند بر حسب عبارات مختصاتی محلی آن نسبت به یک \lr{G}-اطلس از بدیهی‌سازی‌های محلی که $M$ را می‌پوشاند، پیاده‌سازی شود.