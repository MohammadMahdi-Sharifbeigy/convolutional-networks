%!TEX root=../GaugeCNNTheory.tex


\section{کانولوشن‌های هموردا روی فضاهای همگن}
\label{apx:homogeneous_conv}

کارهای کندور و همکاران\cite{Kondor2018-GENERAL}، کوهن وهمکاران\cite{Cohen2018-intertwiners}\cite{Cohen2019-generaltheory} وبکرز و هکاران \cite{bekkers2020bspline} از نظر روحی بسیار شبیه به کار ما هستند، به این معنا که آنها کانولوشن‌های هموردای گروهی را در یک چارچوب نسبتاً عمومی تعریف می‌کنند.
این مقالات در این مشترک هستند که روی \emph{نقشه‌های ویژگی روی فضاهای همگن}~$\I/H$ از یک \emph{گروه تقارن سراسری}~$\I$ عمل می‌کنند، که در آن $H\leq\I$.%
\footnote{
	ما در اینجا از $\I$ برای نشان دادن تقارن‌های سراسری دلخواه استفاده می‌کنیم، نه لزوماً ایزومتری‌ها.
}%
\footnote{
	\cite{Kondor2018-GENERAL,Cohen2019-generaltheory,bekkers2020bspline} به جای $\I$ از $G$ برای اشاره به تقارن‌های سراسری استفاده می‌کنند.
	ما از $\I$ استفاده می‌کنیم زیرا $G$ را برای گروه ساختاری رزرو کرده‌ایم.
}
آنها در انواع گروه‌های $\I$ که پوشش می‌دهند و در تعریف فضاهای ویژگی خود، به ویژه عمل‌های گروهی خطی روی آنها، متفاوت هستند.
قضایای اصلی این مقالات تأیید می‌کنند که \emph{عمومی‌ترین نگاشت‌های خطی هموردا بین چنین فضاهای ویژگی، کانولوشن‌ها} (یا همبستگی‌ها) با \emph{کرنل‌های دارای محدودیت تقارنی} هستند.
جزئیات خاص در مورد این کانولوشن‌های تعمیم‌یافته به فضاهای ویژگی و عمل‌های گروهی خاصی که مدل‌ها در نظر می‌گیرند، بستگی دارد.

این پیوست این نظریه‌ها و ارتباط آنها را با کانولوشن‌های مستقل از مختصات ما بررسی می‌کند.
مهمترین شباهت‌ها و تفاوت‌ها در لیست زیر خلاصه شده‌اند:
\begin{itemize}
	\item[{\rule[2.2pt]{2pt}{2pt}}]
	هر \emph{فضای همگن} یک \emph{منیفلد ریمانی} نیست و هر منیفلد ریمانی یک فضای همگن از گروه ایزومتری خود نیست.%
	\footnote{
		به عنوان مثال، $\I/H = \OO2/\SO2 \cong \{\pm1\}$ یک مجموعه است اما یک منیفلد ریمانی نیست.
		مثال دیگر، کانولوشن‌های گروهی $(\Z^d,+)$ روی شبکه پیکسلی گسسته~$\Z^d$ است.
	}
	با این حال، یک همپوشانی قابل توجه وجود دارد، به عنوان مثال برای \lr{CNN}های اقلیدسی روی $\Euc_d \cong \E{d}/\OO{d}$ یا \lr{CNN}های کروی روی $S^d \cong \OO{d+1}/\OO{d}$.
	\item[{\rule[2.2pt]{2pt}{2pt}}]
	نویسندگان به ترتیب گروه‌های \emph{فشرده}~\cite{Kondor2018-GENERAL}، \emph{فشرده محلی، یکنواخت}~\cite{Cohen2018-intertwiners}\cite{Cohen2019-generaltheory}، و \emph{لی}~\cite{bekkers2020bspline} را در نظر می‌گیرند.
	گروه‌های تقارن سراسری در نظریه ما \emph{ایزومتری‌های}~$M$ یا، به طور خاص برای فضاهای اقلیدسی، گروه‌های \emph{آفين}~$\Aff(G)$ هستند.
	توجه داشته باشید که گروه‌های آفين فشرده نیستند و فقط برای $G\leq\OO{d}$ یکنواخت هستند -- بنابراین گروه‌های آفين عمومی در نظریه‌های مربوطه پوشش داده نمی‌شوند.
	\item[{\rule[2.2pt]{2pt}{2pt}}]
	\lr{CNN}های مستقل از مختصات، تمرکز را از \emph{تقارن‌های سراسری} به \emph{تقارن‌های محلی} منتقل می‌کنند.
	روی فضاهای همگن $\I/H$ این تقارن‌های محلی متناظر با زیرگروه‌های پایدارساز $\Stab{p} \cong H$ از~$\I$ هستند.
	بخش ما~\ref{sec:isometry_intro} روابط بین تقارن‌های سراسری و محلی را با جزئیات بررسی می‌کند ـ
	هموردایی محلی مدل‌ها، هموردایی سراسری آنها را القا می‌کند.
	\item[{\rule[2.2pt]{2pt}{2pt}}]
	مدل‌ها \emph{انواع} مختلفی از میدان‌های ویژگی و \emph{عمل‌های گروهی} را روی آنها فرض می‌کنند:
	کندور و هماران\cite{Kondor2018-GENERAL} و بکرز و همکاران\cite{bekkers2020bspline} میدان‌های اسکالر را روی فضاهای همگن فرض می‌کنند، یعنی توابع با مقادیر حقیقی ${f: \I/H \to \R}$ که مطابق با
	$\phi.f (\zeta.H) = f\big( \phi^{-1} \zeta.H \big)$ تبدیل می‌شوند.%
	\footnote{
		نقشه‌های ویژگی چند-کاناله با روی هم قرار دادن چندین تابع از این نوع ساخته می‌شوند.
		برخلاف مورد میدان‌های ویژگی، کانال‌های منفرد چنین نقشه‌های ویژگی به طور مستقل از یکدیگر تبدیل می‌شوند.
	}
	کوهن وهمکاران\cite{Cohen2018-intertwiners}\cite{Cohen2019-generaltheory} میدان‌های ویژگی از انواع عمومی‌تر $\rho$ را در نظر می‌گیرند
	که به عنوان مقاطعی از کلاف‌های بردار ویژگی همبسته $H$ تعریف می‌شوند.
	قوانین تبدیل آنها با نمایش‌های القایی $\Ind_H^\I \rho$ داده می‌شود.
	این تنظیم، توابع با مقادیر حقیقی از \cite{Kondor2018-GENERAL,bekkers2020bspline} را به عنوان یک مورد خاص هنگام انتخاب نمایش‌های میدان بدیهی
	(یا، همانطور که در ادامه دقیق‌تر بیان می‌شود، نمایش‌های خارج‌قسمتی عمومی‌تر $\rho_\textup{\r{quot}}^{G/H}$ که در آن $H\leq G\leq\I$) پوشش می‌دهد.
	نظریه ما نیز میدان‌های ویژگی را به عنوان مقاطعی از کلاف‌های همبسته مدل می‌کند.
	تبدیل آنها با پوش‌فورواردها $\phi \rhd f := \dphiA \circ f \circ \phi^{-1}$ داده می‌شود، که نمایش‌های القایی را تعمیم می‌دهند.
	\item[{\rule[2.2pt]{2pt}{2pt}}]
	کارهای کندور وهمکاران\cite{Kondor2018-GENERAL}، کوهن وهمکاران\cite{Cohen2018-intertwiners}\cite{Cohen2019-generaltheory} و بکرز و همکاران\cite{bekkers2020bspline} \emph{اشتراک وزن کانولوشنی} را از الزام هموردایی سراسری مدل‌ها استخراج می‌کنند.
	از سوی دیگر، کانولوشن‌های $\GM$ ما، بنا به تعریف، وزن‌ها را روی $G$-ساختار به اشتراک می‌گذارند.
	ما ایده استخراج اشتراک وزن از تقارن‌های سراسری (ایزومتری‌ها) را در بخش~\ref{sec:quotient_kernel_fields} اتخاذ کردیم.
	الزام به هموردایی ایزومتری، اشتراک وزن را روی مدارهای ایزومتری و یک محدودیت پایدارساز را روی کرنل‌ها نتیجه می‌دهد؛ به عنوان مثال به شکل~\ref{fig:isom_invariant_kernel_field_quotient} مراجعه کنید.
	قضیه~\ref{thm:GM_conv_homogeneous_equivalence} تأیید می‌کند که \emph{تبدیلات میدان کرنل هموردای ایزومتری روی فضاهای همگن، کانولوشن‌های $\GM$ هستند} -- این نتیجه نتایج کندور وهمکاران\cite{Kondor2018-GENERAL}، کوهن وهمکاران\cite{Cohen2018-intertwiners}\cite{Cohen2019-generaltheory} و بکرز و همکاران\cite{bekkers2020bspline}
	را به دقت منعکس می‌کند.
	\item[{\rule[2.2pt]{2pt}{2pt}}]
	همه این نظریه‌ها یک \emph{محدودیت تقارنی خطی بر روی فضاهای کرنل} را استخراج می‌کنند.
	در مورد کندور وهمکاران\cite{Kondor2018-GENERAL} و بکرز و همکاران\cite{bekkers2020bspline}، کرنل‌ها اساساً توابع اسکالر روی فضاهای خارج‌قسمتی مضاعف $\Hout\backslash \I/\Hin$ هستند (با فرض همبستگی‌ها، برای کانولوشن‌ها $\Hin$ و $\Hout$ جابجا می‌شوند؛ به ادامه مراجعه کنید).
	کرنل‌های کوهن وهمکاران\cite{Cohen2018-intertwiners}\cite{Cohen2019-generaltheory} و در نظریه ما، یک محدودیت راهبری‌پذیری را برآورده می‌کنند که به انتخاب خاص انواع میدان $\rhoin$ و~$\rhoout$ بستگی دارد.
	توجه داشته باشید که ضریب دترمینان در محدودیت $G$-راهبری‌پذیریکوهن وهمکاران \cite{Cohen2018-intertwiners}\cite{Cohen2019-generaltheory} وجود ندارد زیرا نویسندگان به گروه‌های یکنواخت محدود می‌شوند.
	این ضریب در محدودیت کرنل توسط بکرز و همکاران\cite{bekkers2020bspline} ظاهر می‌شود.
	\item[{\rule[2.2pt]{2pt}{2pt}}]
	در حالی که کندور وهمکاران\cite{Kondor2018-GENERAL} وکوهن وهمکاران \cite{Cohen2018-intertwiners}\cite{Cohen2019-generaltheory} کرنل‌ها را بلافاصله روی گروه یا فضای همگن توصیف می‌کنند،
	بکرز و همکاران\cite{bekkers2020bspline} و کانولوشن‌های $\GM$ ما کرنل‌ها را روی فضاهای مماس تعریف کرده و متعاقباً آنها را از طریق نگاشت نمایی به فضاهای همگن تصویر می‌کنند.
	این رویکردها به طور کلی معادل نیستند، به عنوان مثال زیرا نگاشت نمایی روی یک منیفلد ناهمبند، یک‌به‌یک نیست.
	روی فضاهای اقلیدسی، هر دو رویکرد به وضوح معادل هستند؛ به بخش~\ref{sec:euclidean_affine_equiv} مراجعه کنید.
	قضیه ما~\ref{thm:spherical_kernel_space_iso} در بخش~\ref{sec:spherical_CNNs_fully_equivariant} علاوه بر این، این شکاف را برای کرنل‌های کروی با ارائه یک ایزومورفیسم بین کرنل‌های دو رویکرد، پر می‌کند.
	در عمل، ناسازگاری عمومی بی‌اهمیت است زیرا کرنل‌های شبکه‌های کانولوشنی معمولاً دارای تکیه‌گاه فشرده در داخل شعاع انژکتیویته نگاشت نمایی هستند.
\end{itemize}

ما در ادامه به تفصیل به نظریه‌های
کندور وهمکاران\cite{Kondor2018-GENERAL}، بکرز و همکاران\cite{bekkers2020bspline} و کوهن وهمکاران\cite{Cohen2018-intertwiners}\cite{Cohen2019-generaltheory}
خواهیم پرداخت.
به عنوان یک آمادگی، ابتدا به بحث در مورد فضاهای همگن، کانولوشن‌های گروهی و همبستگی‌های گروهی می‌پردازیم.
برای یک مرور جایگزین از این موضوع، خواننده را به استیوز و همکاران~\cite{esteves2020theoretical} ارجاع می‌دهیم.
ما علاوه بر این می‌خواهیم به کار چاکرابورتی و همکاران\cite{chakraborty2018H-CNNs} اشاره کنیم، که همچنین کانولوشن‌ها را روی فضاهای همگن تعریف می‌کند.
این کار در این بخش با جزئیات بیشتری پوشش داده نشده است زیرا مدل‌های آنها $\Hout=\{e\}$ را فرض می‌کنند، یعنی کرنل‌های کانولوشن آنها نامحدود هستند و همیشه سیگنال ورودی را به یک میدان اسکالر روی~$\I$ ارتقا می‌دهند.






\toclesslab\subsection{ملاحظات عمومی در مورد فضاهای همگن، کانولوشن‌های گروهی و همبستگی‌های گروهی}{apx:homogeneous_preliminaries}

\paragraph{فضاهای همگن:}
فرض کنید $\I$ یک گروه باشد که بر روی یک فضای~$X$ عمل می‌کند.
گفته می‌شود این فضا \emph{همگن} است اگر عمل گروه \emph{متعدی} باشد، یعنی اگر هر دو نقطه $p,q\in X$ با عمل $\I$ به هم مرتبط باشند.
در معادلات، $X$ همگن است اگر و تنها اگر برای هر $p,q\in X$ یک عضو $\phi\in\I$ وجود داشته باشد به طوری که~$q=\phi(p)$.
توجه داشته باشید که عمل بر روی~$X$ لزوماً بدون نقطه ثابت نیست، یعنی هر نقطه $p\in X$ دارای یک زیرگروه پایدارساز بالقوه غیربدیهی $\Stab{p} = {\{\xi\in\I \,|\, \xi(p)=p \}} \leq\I$ است.
می‌توان نشان داد که فضای همگن را می‌توان با فضای خارج‌قسمتی $\I/H$ یکی گرفت که در آن $H = \Stab{p}$ برای یک $p\in X$ است.%
\footnote{
	انتخاب‌های دیگر از نقاط، تحقق‌های دیگری از ایزومورفیسم غیرکانونی $\I/H \cong X$ را به دست می‌دهند.
	هر انتخابی به همان اندازه معتبر است زیرا برای فضاهای همگن $\Stab{p} \cong \Stab{q}$ است.
}

از آنجا که هر فضای همگن به عنوان یک خارج‌قسمت به وجود می‌آید، ما در ادامه همیشه یک زیرگروه $H$ از~$\I$ را در نظر می‌گیریم.
این زیرگروه دارای \emph{هم‌دسته‌های چپ} است، یعنی زیرمجموعه‌هایی به شکل
\begin{align}
	\phi.H\ =\ \big\{ \phi h \,\big|\, h\in H \big\}
\end{align}
که اعضای فضای خارج‌قسمتی (همگن)
\begin{align}
	\I/H\ =\ \big\{ \phi.H \,\big|\, \phi\in \I \big\} \,.
\end{align}
هستند. یک عمل چپ طبیعی از $\I$ بر روی $\I/H$ با
\begin{align}
	\I \times \I/H \to \I/H,\ \ \ \big(\widetilde{\phi},\, \phi.H\big) \mapsto \widetilde{\phi}\phi.H \,.
\end{align}
داده می‌شود. به راحتی دیده می‌شود که این عمل متعدی است، و $\I/H$ را به یک فضای همگن از~$\I$ تبدیل می‌کند.
نگاشت خارج‌قسمتی کانونی
\begin{align}
	\mathscr{q}^{\I}_{\I/H}:\ \I\to \I/H,\ \ \phi \mapsto \phi.H
\end{align}
$\I$ را به یک کلاف اصلی $H$ روی~$\I/H$ تبدیل می‌کند.
تعاریف مشابهی را می‌توان برای \emph{هم‌دسته‌های راست}
\begin{align}
	H.\phi\ \ &\in\ \ H\backslash\I \,.
	\intertext{و \emph{هم‌دسته‌های مضاعف}}
	\widetilde{H}.\phi.H\ \ &\in\ \ \widetilde{H} \backslash\I/H
\end{align}
و فضاهای خارج‌قسمتی مربوطه آنها انجام داد.


یک ویژگی جهانی از نگاشت‌های خارج‌قسمتی $\mathscr{q}^{\I}_{\I/H}$ که در بحث ما در ادامه مهم خواهد شد، به شرح زیر است.
فرض کنید $f^\uparrow: \I \to \R$ یک تابع پیوسته و ناوردای-راست نسبت به $H$ باشد، یعنی تابعی که $f^\uparrow(\phi h) = f^\uparrow(\phi)$ را برای هر $\phi\in\I$ و~$h\in H$ برآورده می‌کند.
آنگاه یک تابع پیوسته یکتا $f: \I/H \to \R$ وجود دارد به طوری که $f^\uparrow = f \circ \mathscr{q}^{\I}_{\I/H}$ است.
برعکس، می‌توان هر نگاشت پیوسته $f: \I/H \to \R$ را به طور یکتا به یک نگاشت ناوردای-راست نسبت به $H$ به صورت $f^\uparrow: \I \to \R$ ارتقا داد، که توسط کندور وهمکاران\cite{Kondor2018-GENERAL} برای تعمیم کانولوشن‌های گروهی به فضاهای همگن استفاده می‌شود.
رابطه بین هر دو تابع در نمودار جابجایی زیر به تصویر کشیده شده است:
\begin{equation}
	\label{cd:left_cosets_lift}
	\begin{tikzcd}[column sep=55pt, row sep=35pt, font=\normalsize]
		\I
		\arrow[rd, "{!f^\uparrow := f\circ \mathscr{q}^{\I}_{\overset{}{\I/H}}}"]
		\arrow[d, "{\mathscr{q}^{\I}_{\overset{}{\I/H}}}"']
		\\
		\I/H
		\arrow[r, "f"']
		& \R
	\end{tikzcd}
\end{equation}
یک ساختار مشابه را می‌توان به وضوح برای فضاهای خارج‌قسمتی راست $H\backslash\I$ و نگاشت‌های ناوردای-چپ نسبت به $H$ انجام داد.
نمودار جابجایی زیر مورد فضاهای خارج‌قسمتی مضاعف $\widetilde{H} \backslash \I/H$ و نگاشت‌های $f^\uparrow$ را که همزمان ناوردای-چپ نسبت به $\widetilde{H}$ و ناوردای-راست نسبت به $H$ هستند، به تصویر می‌کشد، یعنی در ${f^\uparrow\big(\widetilde{h}\phi h\big) = f^\uparrow(\phi)}$ برای هر ${\phi\in\I}$, ${\widetilde{h}\in\widetilde{H}}$ و ${h\in H}$ صدق می‌کنند:
\begin{equation}
	\label{cd:double_cosets_lift}
	\begin{tikzcd}[column sep=55pt, row sep=35pt, font=\normalsize]
		\I
		\arrow[rd, "{!f^\uparrow := f\circ \mathscr{q}^{\I}_{\overset{}{\widetilde{H} \backslash \I/H}}}"]
		\arrow[d, "{\mathscr{q}^{\I}_{\overset{}{\widetilde{H} \backslash \I/H}}}"']
		\\
		\widetilde{H} \backslash \I/H
		\arrow[r, "f"']
		& \R
	\end{tikzcd}
\end{equation}




\paragraph{کانولوشن‌های گروهی و همبستگی‌های گروهی:}
کانولوشن‌ها به طور طبیعی از فضاهای اقلیدسی (یا گروه‌های انتقال) به گروه‌های فشرده محلی دلخواه تعمیم داده می‌شوند.
فرض کنید $\I$ یک گروه فشرده محلی باشد و $d\zeta$ یک اندازه هار چپ روی~$\I$ باشد.
\emph{کانولوشن گروهی} $(f \ast_{\overset{}{\protect\scalebox{.64}{$\mkern-.5mu \I$}}} \kappa): \I \to \R$ از دو تابع انتگرال‌پذیر $f:\I\to\R$ و $\kappa:\I\to\R$ سپس با عبارات معادل زیر، که از \cite{gallier2019harmonicRepr} گرفته شده‌اند، تعریف می‌شود:
\begin{align}\label{eq:group_conv_def}
	\big(f \ast_{\overset{}{\protect\scalebox{.64}{$\mkern-.5mu \I$}}} \kappa \big)(\phi)
	:&=\ \int_{\I} f(\zeta)\, \kappa\big( \zeta^{-1} \phi \big) \; d\zeta \notag \\
	&=\ \int_{\I} f(\phi\, \zeta)\, \kappa\big( \zeta^{-1}\big) \; d\zeta \notag \\
	&=\ \int_{\I} f\big(\zeta^{-1} \big)\, \kappa( \zeta\phi)\: \Delta(\zeta^{-1}) \; d\zeta \notag \\
	&=\ \int_{\I} f\big(\phi\, \zeta^{-1} \big)\, \kappa( \zeta)\: \Delta(\zeta^{-1}) \; d\zeta \,,
\end{align}
همومورفیسم گروهی $\Delta: \I \to (\R^+_{>0},*)$ که در دو عبارت آخر ظاهر می‌شود، تابع مدولار~$\I$ است.
کندور وهمکاران\cite{Kondor2018-GENERAL} کانولوشن‌های گروهی را مانند خط آخر تعریف می‌کنند، با این حال، بدون تابع مدولار.
این معتبر است زیرا نویسندگان گروه‌های فشرده را فرض می‌کنند، که یکنواخت هستند، یعنی $\Delta(\phi) = 1$ را برای هر $\phi \in\I$ برآورده می‌کنند.


مرتبط با کانولوشن‌های گروهی، \emph{همبستگی‌های گروهی} هستند
\begin{align}\label{eq:group_corr_def}
	\big(f \star_{\overset{}{\protect\scalebox{.64}{$\mkern-.5mu \I$}}} \kappa \big)(\phi)
	\ :=\ \big\langle f,\, \phi.\kappa \big\rangle_{L^1(\I)}
	\ =\ \int_{\I} f(\zeta)\, \kappa\big( \phi^{-1} \zeta \big) \; d\zeta\ ,
\end{align}
که به عنوان حاصلضرب داخلی یک تابع~$f$ با یک کرنل جابجا شده~$\phi.\kappa$ تعریف می‌شوند.
یک مقایسه با معادله~\eqref{eq:group_conv_def} نشان می‌دهد که کانولوشن‌های گروهی و همبستگی‌های گروهی تا یک وارونگی آرگومان کرنل، معادل هستند، یعنی،
\begin{align}\label{eq:group_conv_corr_kernel_inversion}
	\big(f \star_{\overset{}{\protect\scalebox{.64}{$\mkern-.5mu \I$}}} \kappa \big)
	\ =\ \big(f \ast_{\overset{}{\protect\scalebox{.64}{$\mkern-.5mu \I$}}} \big[\kappa \circ (\,\cdot\,)^{-1} \big] \big) \,.
\end{align}
در حالی که کندور وهمکاران\cite{Kondor2018-GENERAL} کانولوشن‌های گروهی (تعمیم‌یافته) را در نظر می‌گیرند، بکرز و همکاران\cite{bekkers2020bspline} و کوهن وهمکاران\cite{Cohen2019-generaltheory} همبستگی‌ها را فرض می‌کنند ـ برای تطبیق نظریه‌ها باید آرگومان‌های کرنل را وارون کرد.


کانولوشن‌های گروهی و همبستگی‌های گروهی بنا به تعریف نسبت به عمل‌های چپ $\alpha.f(\phi) = f\big( \alpha^{-1}\phi \big)$ از اعضای گروه $\alpha\in\I$ بر روی عامل اول \emph{هموردا} هستند.
برای مورد کانولوشن‌ها، این با
\begin{align}\label{eq:group_conv_equivariance}
	\big( [\alpha.f] \ast_{\overset{}{\protect\scalebox{.64}{$\mkern-.5mu \I$}}} \kappa \big)(\phi)
	\ &=\ \int_{\I} \big[\alpha.f \big](\zeta)\, \kappa\big( \zeta^{-1} \phi \big) \; d\zeta \notag \\
	\ &=\ \int_{\I} f\big( \alpha^{-1} \zeta\big)\, \kappa\big( \zeta^{-1} \phi \big) \; d\zeta \notag \\
	\ &=\ \int_{\I} f\big(\widetilde{\zeta} \big)\, \kappa\big( \widetilde{\zeta}^{-1} \alpha^{-1} \phi \big) \; d\big( \alpha \widetilde{\zeta} \big) \notag \\
	\ &=\ \big( f \ast_{\overset{}{\protect\scalebox{.64}{$\mkern-.5mu \I$}}} \kappa \big) (\alpha^{-1} \phi) \notag \\
	\ &=\ \big[\alpha.( f \ast_{\overset{}{\protect\scalebox{.64}{$\mkern-.5mu \I$}}} \kappa )\big] (\phi) \,,
\end{align}
نشان داده می‌شود، که در آن ما در مرحله سوم $\widetilde{\zeta} = \alpha^{-1}\zeta$ را جایگزین کردیم و از این واقعیت استفاده کردیم که $d\widetilde{\zeta}$ یک اندازه هار چپ است، یعنی $d\big(\alpha \widetilde{\zeta}\big) = d\widetilde{\zeta}$ را برآورده می‌کند.
مورد همبستگی‌ها به طور بدیهی از معادله~\eqref{eq:group_conv_corr_kernel_inversion} نتیجه می‌شود.


اکثر \lr{CNN}های هموردا بر کانولوشن‌های گروهی یا همبستگی‌های گروهی تکیه دارند.
به طور خاص، مدل‌های ردیف‌های (۱-۳)، (۵)، (۱۱)، (۱۵)، (۱۹)، (۲۱)، (۲۴)، (۲۵) و (۳۲) از جدول~\ref{tab:network_instantiations} که همگی با نمایش‌های منظم برچسب‌گذاری شده‌اند (یا می‌توانند به طور معادل برچسب‌گذاری شوند)، \lr{CNN}های کانولوشنی گروهی هستند.
پیش از استفاده از آنها در \lr{CNN}های هموردا، کانولوشن‌های گروهی به طور گسترده در رباتیک~\cite{chirikjian1998numerical} یا برای تحلیل تصویر~\cite{mallat2012group,sifre2012combined,Sifre2013-GSCAT,bruna2013invariant,sifre2014rigid,oyallon2015scattering} به کار رفته‌اند.
کوهن وهمکاران\cite{Cohen2016-GCNN} نشان دادند که کانولوشن‌های گروهی (یا بهتر بگوییم همبستگی‌ها) به طور طبیعی کانولوشن‌های متعارف را تعمیم می‌دهند.
از آنجا که نقشه‌های ویژگی شبکه‌های کانولوشنی شامل چندین کانال هستند، آنها با توابع با مقادیر حقیقی روی $\I$ داده نمی‌شوند بلکه با توابع با مقادیر برداری $f: \I \to \R^c$ داده می‌شوند.
کرنل‌ها بر این اساس به عنوان توابع ماتریسی (نامحدود) روی گروه تعریف می‌شوند، یعنی $\kappa: \I \to \R^{\cout\times\cin}$.
کارهای کندور وهمکاران\cite{Kondor2018-GENERAL}، بکرز و همکاران\cite{bekkers2020bspline} و کوهن وهمکاران\cite{Cohen2018-intertwiners}\cite{Cohen2019-generaltheory} که در ادامه مرور می‌کنیم، چنین شبکه‌های کانولوشنی گروهی را به فضاهای همگن دلخواه تعمیم می‌دهند.







\toclesslab\subsection{کانولوشن‌های میدان اسکالر روی فضاهای همگن}{apx:homogeneous_scalar_field_convs}

ما با شبکه‌های کانولوشنی (یا همبستگی) $\I$-هموردا روی فضاهای همگن توسط کندور وهمکاران\cite{Kondor2018-GENERAL} و بکرز و همکاران\cite{bekkers2020bspline} شروع می‌کنیم.
هر دو نظریه، نقشه‌های ویژگی را به عنوان \emph{میدان‌های اسکالر روی فضاهای همگن} تعریف می‌کنند، یعنی هر کانال با یک تابع با مقادیر حقیقی
\begin{align}\label{eq:scalar_field_homogeneous_space}
	f: \I/H \to \R \,.
\end{align}
داده می‌شود. کانال‌های منفرد به طور مستقل تحت عمل گروه تقارن سراسری $\I$ همانطور که با
\begin{align}\label{eq:group_action_homogeneous_space_scalar_field}
	\big[\mkern1mu \widetilde{\phi}.f\big] (\phi.H)\ :=\ f\big( \widetilde{\phi}^{-1} \phi.H \big)
	\qquad\ \widetilde{\phi}\in H,\ \ \ \phi.H\in \I/H \,.
\end{align}
مشخص شده است، تبدیل می‌شوند.

هر لایه $l = 1,\dots, L$ ممکن است یک زیرگروه متفاوت $H_l \leq\I$ و در نتیجه یک فضای همگن $\I/H_l$ داشته باشد که نقشه‌های ویژگی آن روی آن زندگی می‌کنند.
این به عنوان مثال اجازه می‌دهد تا کانولوشن‌های ارتقا دهنده از کره $S^2 \cong \SO3/\SO2$ به منیفلد گروه $\SO3 \cong \SO{3}/\{e\}$ را با انتخاب به ترتیب زیرگروه‌های $\SO2$ و $\{e\}$ مدل‌سازی کنیم.
انتخاب‌های زیرگروه‌ها به نوعی با انتخاب‌های نمایش‌های گروهی در نظریه ما مطابقت دارند، که در ادامه بیشتر توضیح خواهیم داد.

نتایج این دو مقاله تا حد زیادی معادل هستند، با این حال،
کندور وهمکاران\cite{Kondor2018-GENERAL} گروه‌های فشرده $\I$ و کانولوشن‌ها را در نظر می‌گیرند
در حالی که بکرز و همکاران\cite{bekkers2020bspline} فرض می‌کند $\I$ یک گروه لی است و از همبستگی‌ها استفاده می‌کند.



\paragraph{\lr{\citet{Kondor2018-GENERAL}}:}

به طور خلاصه، کندور وهمکاران\cite{Kondor2018-GENERAL} عمومی‌ترین نگاشت‌های خطی $\I$-هموردا را بین ویژگی‌های میدان اسکالر روی فضاهای همگن $\I/\Hin$ و $\I/\Hout$ با فرض قانون تبدیل در معادله~\eqref{eq:group_action_homogeneous_space_scalar_field} بررسی می‌کنند.
آنها اثبات می‌کنند که این عملیات با یک کانولوشن گروهی تعمیم‌یافته با یک کرنل
\begin{align}
	\kappa: \Hin\backslash \I/\Hout \to \R
\end{align}
روی فضای خارج‌قسمتی مضاعف مشخص شده توسط $\Hin$ و $\Hout$ داده می‌شود.
با فرمول‌بندی برای گروه‌های متناهی، همانطور که توسط نویسندگان انجام شده است، نشان داده می‌شود که این عملیات کانولوشن تعمیم‌یافته با
\begin{align}\label{eq:quotient_space_conv_Kondor}
	\big(f \ast_{\overset{}{\scalebox{.64}{$\I/\Hin$}}} \kappa \big) (\phi.\Hout)
	\ \ :=\ \ |\Hin| \sum_{\Hin.\zeta \,\in\, \Hin\mkern-2.5mu\backslash\mkern-.5mu\I}
	f\big( \phi\mkern2mu \zeta^{-1}\!. \Hin\big)\ \kappa\big( \Hin.\zeta.\Hout \big) \,.
\end{align}
داده می‌شود. یک مقایسه با خط آخر معادله~\eqref{eq:group_conv_def} نشان می‌دهد که این عملیات واقعاً به شدت به کانولوشن‌های گروهی مرتبط است -- تابع مدولار $\Delta$ حذف می‌شود زیرا $\I$ فشرده و در نتیجه یکنواخت است.
کانولوشن تعمیم‌یافته در واقع معادل یک کانولوشن گروهی
\begin{align}
	\big(f \ast_{\overset{}{\scalebox{.64}{$\I/\Hin$}}} \kappa \big) (\phi.\Hout)
	\ =\ \big(f^\uparrow \ast_{\overset{}{\protect\scalebox{.64}{$\mkern-.5mu \I$}}} \kappa^\uparrow \big)(\phi)
\end{align}
با ویژگی‌ها و کرنل‌هایی است که مطابق با نمودارهای معادلات~\eqref{cd:left_cosets_lift} و~\eqref{cd:double_cosets_lift} ارتقا یافته‌اند.
توجه داشته باشید که کرنل کانولوشن روی $\Hin\backslash \I/\Hout$ متناظر با یک کرنل همبستگی روی $\Hout\backslash \I/\Hin$ است زیرا کانولوشن‌ها و همبستگی‌ها طبق معادله~\eqref{eq:group_conv_corr_kernel_inversion} با یک وارونگی آرگومان کرنل به هم مرتبط هستند.
بنابراین می‌توان کرنل‌های کندور وهمکاران\cite{Kondor2018-GENERAL} را به عنوان کرنل‌های همبستگی ناوردای-چپ نسبت به $\Hout$ روی فضای ورودی~$\I/\Hin$ در نظر گرفت.


برای ارائه یک شهود در مورد این نتایج، به مثال \lr{CNN} کروی خود که در بالا ذکر شد، باز می‌گردیم.
بنابراین فرض کنید $\I=\SO3$، $\Hin=\SO2$ و برای حال، $\Hout=\{e\}$.
این تنظیم، کانولوشن‌های ارتقا دهنده از کره ۲-بعدی $\I/\Hin = \SO3/\SO2 \cong S^2$ را به منیفلد گروه دوران $\I/\Hout = \SO3/\{e\} \cong \SO3$ توصیف می‌کند.
با در نظر گرفتن همبستگی‌ها به جای کانولوشن‌ها، کرنل‌ها توابع با مقادیر حقیقی روی $\Hout\backslash \I/\Hin = \{e\}\backslash \SO3/\SO2 \cong S^2$ هستند.
اگر به جای آن $\Hout=\SO2$ را قرار دهیم، کانولوشن از میدان‌های اسکالر روی کره ۲-بعدی به میدان‌های اسکالر روی کره ۲-بعدی $\I/\Hout = \SO3/\SO2$ نگاشت می‌دهد.
در این حالت، کرنل‌های همبستگی با توابع با مقادیر حقیقی روی $\SO2\backslash \SO3/\SO2$ داده می‌شوند.
به طور معادل، کرنل‌های همبستگی با توابع ناوردای-چپ نسبت به~$\SO2$ روی~$S^2$ داده می‌شوند، یعنی کرنل‌های ناحیه‌ای همانطور که در شکل~\ref{fig:zonal_kernel} به تصویر کشیده شده است.
هنگام فرض $\Hin=\Hout=\{e\}$، ما $\I/\Hin = \I/\Hout \cong \SO3$ و کرنل‌های نامحدود روی $\Hout\backslash \I/\Hin \cong \SO3$ را داریم، که متناظر با کانولوشن‌های گروهی متعارف (یا همبستگی‌ها) است.
این نتایج با بحث ما در بخش~\ref{sec:spherical_CNNs_fully_equivariant} مطابقت دارد.


برای کامل بودن، ما اشاره می‌کنیم که کندور وهمکاران\cite{Kondor2018-GENERAL} نتایج خود را علاوه بر این از یک دیدگاه نظریه نمایشی، یعنی با ویژگی‌ها و کرنل‌ها در فضای فوریه، توضیح می‌دهند.
این واقعیت که ویژگی‌ها و کرنل‌ها روی فضاهای خارج‌قسمتی زندگی می‌کنند، در این فرمول‌بندی در الگوهای پراکندگی ضرایب فوریه منعکس می‌شود.








\paragraph{\lr{\citet{bekkers2020bspline}}:}

به جای در نظر گرفتن گروه‌های فشرده، بکرز و همکاران\cite{bekkers2020bspline} فرض می‌کند $\I$ یک گروه لی عمومی است.
نقشه‌های ویژگی لایه~$l$ به عنوان توابع انتگرال‌پذیر مربع با مقادیر حقیقی در $L^2(\I/H_l)$ تعریف می‌شوند
که هنگام عمل~$\I$ بر روی آنها، مطابق با معادله~\eqref{eq:group_action_homogeneous_space_scalar_field} تبدیل می‌شوند.

بکرز و همکاران\cite{bekkers2020bspline} لایه‌های شبکه‌های کانولوشنی (یا بهتر بگوییم همبستگی) خود را به عنوان عملگرهای خطی کران‌دار
\begin{align}
	\mathfrak{K}:\ L^2(\I/\Hin) \to L^2(\I/\Hout)
\end{align}
بین نقشه‌های ویژگی روی فضاهای همگن $\I/\Hin$ و~$\I/\Hout$ مدل می‌کند.
چنین عملگرهایی به طور کلی با عملگرهای انتگرالی به شکل
\begin{align}
	\big[\mathfrak{K}f\big] (\phi.\Hout)\ =\ 
	\int_{\I/\Hin} \widehat{\kappa} \big(\phi.\Hout,\, \zeta.\Hin \big)\ f(\zeta.\Hin)\,\ \dmuIHin \,,
\end{align}
داده می‌شوند، که در آن $\dmuIHin$ یک اندازه رادون روی $\I/\Hin$ و
\begin{align}
	\widehat{\kappa}:\ \I/\Hout \times \I/\Hin \to \R
\end{align}
یک کرنل ۲-آرگومانی انتگرال‌پذیر است.

الزام بر روی عملگر برای هموردا بودن، یعنی،
\begin{align}
	\mathfrak{K}\big( \phi.f \big)\ =\ \phi \mkern1mu.\mkern1.5mu \mathfrak{K}(f)
	\qquad \forall\,\ \phi\in\I,\ \ f\in L^2(\I/\Hin) \ ,
\end{align}
نشان داده می‌شود که دلالت بر این دارد که کرنل ۲-آرگومانی به یک کرنل تک‌آرگومانی کاهش می‌یابد
\begin{align}
	\widehat{\kappa} \big(\phi.\Hout,\, \zeta.\Hin \big)
	\ =\ \frac{\dmuIHin(\phi^{-1} \zeta.\Hin)}{\dmuIHin(\zeta.\Hin)}\ \kappa\big(\phi^{-1} \zeta.\Hin \big) \,.
\end{align}
عضو گروه $\phi\in \phi.\Hout \subset \I$ در اینجا یک نماینده دلخواه از هم‌دسته‌ای است که در آن قرار دارد.
این کرنل ۱-آرگومانی ـ تا یک ضریب مقیاس وابسته به اندازه -- محدود به ناوردایی-چپ نسبت به $\Hout$ است:
\begin{align}
	\kappa(\zeta.\Hin)\ =\ \frac{\dmuIHin(\xi^{-1} \zeta.\Hin)}{\dmuIHin(\zeta.\Hin)}\ \kappa\big(\xi^{-1} \zeta.\Hin \big)
	\qquad \forall\ \ \zeta.\Hin \in \I/\Hin,\ \ \xi\in\Hout
\end{align}
توجه داشته باشید که این نتیجه بسیار شبیه به نتیجهکندور وهمکاران \cite{Kondor2018-GENERAL} است زیرا یک کرنل ناوردای-چپ نسبت به $\Hout$ روی $\I/\Hin$ معادل یک عضو از $\Hout\backslash \I/\Hin$ است (دوباره با فرض کرنل‌های همبستگی به جای کرنل‌های کانولوشن).
تفاوت اصلی ضریب مقیاس اضافی است، که ظاهر می‌شود زیرا اندازه رادون $\dmuIHin$ لزوماً ناوردای-چپ نسبت به $\I$ نیست.


یکی از موارد عملی مرتبط، همبستگی‌های گروهی است، که برای آنها $\Hin = \{e\}$ و $\I/\{e\} = \I$ است.
در این حالت $d\mu_{\overset{}{\I}}$ یک اندازه هار (ناوردای) چپ روی $\I$ است، به طوری که ضریب مقیاس حذف می‌شود.
مورد مرتبط دیگر، کانولوشن‌های هموردای آفين روی فضاهای اقلیدسی است، یعنی انتخاب‌های $\I = \Aff(G)$ و $\Hin=G$ که برای آنها $\I/\Hin \cong \R^d$ است.
با فرض اینکه $\dmuIHin$ اندازه لبگ روی $\R^d$ باشد و با نشان دادن $\phi=tg \in \I$، بکرز\cite{bekkers2020bspline} اثبات می‌کند که ضریب مقیاس در این حالت با
\begin{align}
	\frac{\dmuIHin\!( (tg)^{-1}x )}{\dmuIHin\!(x)}\ =\ \frac{1}{\detg} \qquad \forall\ x\in\R^d
\end{align}
داده می‌شود. این دقیقاً همان ضریب دترمینان است که در محدودیت کرنل $G$-راهبری‌پذیر ما، معادله~\eqref{eq:kernel_constraint}، نیز ظاهر می‌شود.


از آنجا که $\SO3$ یک گروه لی است، مثال‌های \lr{CNN} کروی که ما پس از بحث در مورد نظریه کندور وهمکاران\cite{Kondor2018-GENERAL} ارائه دادیم، بدون تغییر اعمال می‌شوند (با فرض اندازه استاندارد ناوردای-چپ روی $S^2$).


بکرز و همکاران\cite{bekkers2020bspline} کرنل‌ها را در شباهت نزدیک با کانولوشن‌های $\GM$ ما روی فضاهای مماس تعریف کرده و آنها را متعاقباً از طریق نگاشت‌های نمایی به فضاهای همگن تصویر می‌کند.
کرنل‌ها روی فضاهای مماس در اینجا از طریق B-اسپلاین‌ها مدل‌سازی می‌شوند.
یک تفاوت این است که بکرز و همکاران\cite{bekkers2020bspline} نیازی به در نظر گرفتن انتقال‌دهنده‌های موازی ندارد زیرا او نقشه‌های ویژگی اسکالر را روی فضاهای همگن فرض می‌کند.





\paragraph{ارتباط با کانولوشن‌های \emph{\lr{GM}}:}

به دلیل فرمول‌بندی کاملاً متفاوت، بلافاصله مشخص نیست که نتایج کندور وهمکاران \cite{Kondor2018-GENERAL} و بکرز و همکاران\cite{bekkers2020bspline} چگونه با نظریه ما مرتبط هستند.
به جای در نظر گرفتن فضاهای خارج‌قسمتی مختلف $\I/H_l$ در هر لایه~$l$ ما یک منیفلد ثابت~$M$ را در نظر می‌گیریم.
برای دیدن اینکه چگونه هر دو رویکرد به هم متصل می‌شوند، یک زیرگروه دیگر~$G$ را فرض کنید به طوری که $H_l \leq G \leq \I$ برای همه لایه‌ها~$l=1,\dots,L$ و $M := \I/G$ یک منیفلد باشد، را برآورده کند.
ویژگی‌های اسکالر روی $\I/H_l$ را می‌توان در این حالت به عنوان میدان‌های ویژگی همبسته $G$ روی $M$ در نظر گرفت که مطابق با \emph{نمایش‌های خارج‌قسمتی}~$\rho_\textup{\lr{quot}}^{G/H_l}$ تبدیل می‌شوند.
برای دیدن این، توجه داشته باشید که عمل گروه در معادله~\eqref{eq:group_action_homogeneous_space_scalar_field} چیزی جز نمایش القایی $\Ind_{H_l}^{\I} \rho_\textup{\lr{triv}}^{H_l} = \rho_\textup{\lr{quot}}^{\I/H_l}$ از نمایش بدیهی $H_l$ نیست، که قانون تبدیل میدان‌های اسکالر روی~$\I/H_l$ را توصیف می‌کند.
این نمایش را می‌توان از طریق القا در مراحل (به~\cite{ceccherini2009induced} مراجعه کنید) به
\begin{align}
	\Ind_{H_l}^{\I} \rho_\textup{\lr{triv}}^{H_l}
	\ =\ \Ind_G^{\I} \Ind_{H_l}^G \rho_\textup{\lr{triv}}^{H_l}
	\ =\ \Ind_G^{\I} \rho_\textup{\lr{quot}}^{G/H_l} \,,
\end{align}
تجزیه کرد، یعنی به القای نمایش خارج‌قسمتی $\rho_\textup{\lr{quot}}^{G/H_l}$ از~$G$ به~$\I$.
بنابراین توابع با مقادیر حقیقی روی $\I/H_l$ معادل میدان‌های $\rho_\textup{\lr{quot}}^{G/H_l}$ روی~$M=\I/G$ هستند.


موارد خاص جالب $G=H_l$ و $G=\{e\}$ هستند.
برای اولی، $\rho_\textup{\lr{quot}}^{G/H_l} = \rho_\textup{\lr{triv}}^G$ را داریم، که میدان‌های اسکالر را روی~$M = \I/G = \I/H_l$ توصیف می‌کند.
برای دومی، $\rho_\textup{\lr{quot}}^{G/H_l} = \rho_\textup{\lr{reg}}^G$ نمایش منظم است، که متناظر با کانولوشن‌های گروهی متعارف است.


این بینش‌ها دلالت بر این دارند که نظریه کندور وهمکاران\cite{Kondor2018-GENERAL} تمام مدل‌های جدول~\ref{tab:network_instantiations} را که روی فضاهای همگن از گروه‌های فشرده $\I$ عمل می‌کنند و با نمایش‌های بدیهی، منظم یا خارج‌قسمتی عمومی‌تر برچسب‌گذاری شده‌اند، توضیح می‌دهد -- اینها اساساً \lr{CNN}های کروی در ردیف‌های (۳۲) و (۳۳) هستند.
یک تعمیم جزئی نظریه به گروه‌های فشرده محلی و یکنواخت، علاوه بر این برخی از \lr{CNN}های اقلیدسی هموردای ایزومتری را توصیف می‌کند.
از آنجا که بکرز و همکاران\cite{bekkers2020bspline} گروه‌های لی دلخواه را فرض می‌کند، مدل‌های او علاوه بر این \lr{CNN}های $\Aff(G)$-هموردا را در جدول~\ref{tab:network_instantiations} که با نمایش‌های بدیهی، منظم یا خارج‌قسمتی عمومی‌تر برچسب‌گذاری شده‌اند، پوشش می‌دهند.
آنها به طور خاص \lr{CNN}های اقلیدسی هموردای مقیاسی ($G=\Scale$) را که برای آنها ضریب دترمینان $\detg$ غیربدیهی است، پوشش می‌دهند.


انواع دیگر میدان‌های ویژگی و فضاهای غیرهمگن مانند فضاهای اقلیدسی سوراخ‌دار $\Euc_d\backslash\{0\}$ و کره‌های $S^2\backslash\{n,s\}$، بیست‌وجهی، سطوح عمومی و نوار موبیوس پوشش داده نمی‌شوند.