%!TEX root=../GaugeCNNTheory.tex


\subsection{\{e\}-کانولوشن‌های سطحی راهبری‌پذیر}
\label{sec:e_surface_conv}


این بخش شبکه‌های \cite{monti2017geometric,jin2018learning,schonsheck2018parallel,tatarchenko2018tangent,jin2019NPTCnet,li2019crossAtlas} را مرور می‌کند،
که در این مشترک هستند که بر $\{e\}$-ساختارها روی سطوح تکیه دارند.
از دیدگاه کانولوشن‌های $\GM$， این معماری‌ها عمدتاً در انتخاب خاص \emph{روش ابتکاری که $\{e\}$-ساختار را تعیین می‌کند} متفاوت هستند.


با فرض یک گروه ساختاری بدیهی $G=\{e\}$، مدل‌ها کرنل‌های $\{e\}$-راهبری‌پذیر (یعنی نامحدود) را اعمال می‌کنند، که در امتداد چارچوب‌های $\{e\}$-ساختار انتخاب شده تراز شده‌اند.
انواع میدان (نمایش‌های گروهی) لزوماً بدیهی هستند.
همین امر برای تمام انتقال‌دهنده‌های موازی نیز صادق است، که لزوماً با $\{e\}$-ساختار سازگار هستند.
بنابراین پول‌بک‌های انتقال‌دهنده $\Expspf$ از میدان‌های ویژگی $f$ به فضاهای مماس، به پول‌بک‌های $\exp_p^*f$ توسط نگاشت نمایی معمول کاهش می‌یابند، یعنی آنها انتقال‌دهنده‌های (غیربدیهی) را اعمال نمی‌کنند.
به یاد بیاورید که $\{e\}$-ساختارهای پیوسته فقط روی منیفلدهای موازی‌پذیر وجود دارند، که این دلالت بر این دارد که استنتاج شبکه‌ها به ناچار روی سطوح غیرموازی‌پذیر ناپیوسته است.
روش‌های ابتکاری که میدان‌های چارچوب را تعیین می‌کنند، علاوه بر این، همیشه خوش‌تعریف نیستند، یا تحت تغییر شکل‌های هندسه سطوح ناپایدار هستند، همانطور که در ادامه بیشتر مورد بحث قرار می‌گیرد.

مدل‌های \citet{monti2017geometric}، \citet{jin2018learning} و \citet{schonsheck2018parallel} روی مش‌های مثلثی عمل می‌کنند و میدان‌های ویژگی را که در رئوس نمونه‌برداری شده‌اند، پردازش می‌کنند.
\citet{tatarchenko2018tangent} و \citet{jin2019NPTCnet} شبکه‌هایی را پیشنهاد می‌کنند که روی ابرهای نقطه سطحی عمل می‌کنند در حالی که معماری \citet{li2019crossAtlas} کانولوشن‌ها را روی اطلس‌های بافت از مش‌ها تعریف می‌کند.





\paragraph{MoNetهای ژئودزیک:}
اولین خانواده مدلی که ما مورد بحث قرار می‌دهیم، \emph{MoNet}ها توسط \citet{monti2017geometric} هستند.
نویسندگان انواع مختلفی از مدل‌ها را روی گراف‌ها و منیفلدها مورد بحث قرار می‌دهند، که اکثر آنها به عنوان کانولوشن‌های $\GM$ توضیح داده نمی‌شوند.
این مدل‌ها در این مشترک هستند که کرنل‌ها را نسبت به یک انتخاب از «شبه-مختصات» روی منیفلد یا گراف اعمال می‌کنند
-- ما در اینجا فقط به آن دسته از MoNetها علاقه‌مندیم که بر مختصات نرمال ژئودزیک تکیه دارند و بنابراین به عنوان کانولوشن‌های $\GM$ شناسایی می‌شوند.

همانطور که در بالا گفته شد، تفاوت اصلی بین کانولوشن‌های سطحی $\{e\}$-راهبری‌پذیر، انتخاب خاص $\{e\}$-ساختار آنهاست.
با الهام از کار قبلی \citet{boscaini2016learning}%
\footnote{
	\emph{\lr{CNN}های ناهمسانگرد} توسط \citet{boscaini2016learning} همان $\{e\}$-ساختار مبتنی بر جهت انحنای اصلی را فرض می‌کنند.
	با این حال، کرنل‌های آنها در مختصات نرمال ژئودزیک تعریف نشده‌اند بلکه بر اساس کرنل‌های گرمای ناهمسانگرد روی منیفلد هستند.
	\citet{monti2017geometric} ادعا می‌کنند که چنین کرنل‌های گرمایی متناظر با کرنل‌های گاوسی ناهمسانگرد در مختصات ژئودزیک هستند -- اگر این گزاره درست باشد، \lr{CNN}های ناهمسانگرد را می‌توان به عنوان کانولوشن‌های $\GM$ در نظر گرفت.
}،
نویسندگان انتخاب می‌کنند که چارچوب‌های مرجع $\{e\}$-ساختار را با \emph{جهت انحنای اصلی} منیفلد تراز کنند.
توجه داشته باشید که این روش ابتکاری زمانی که انحناهای اصلی $\kappa_{\textup{max}} = \kappa_{\textup{min}}$ برابر باشند، یعنی زمانی که جهت انحنای اصلی تبهگن است، خوش‌تعریف نیست.
یک مثال افراطی، کره ۲-بعدی $S^2$ است، که در آن جهت انحنای اصلی در هیچ کجا به خوبی تعریف نشده است.
حتی زمانی که انحناهای اصلی نابرابر هستند، آنها فقط یک خط بدون جهت را تعیین می‌کنند، و چارچوب‌های مرجع را تا یک $\operatorname{C}_2$-ساختار (با دو چارچوب تشکیل‌دهنده که در امتداد دو جهت در طول خط اشاره می‌کنند) از ابهام خارج می‌کنند.
بنابراین برای اینکه شبکه مستقل از انتخاب چارچوب باشد، آنها در واقع باید کرنل‌های $\operatorname{C}_2$-راهبری‌پذیر را اعمال کنند.
علاوه بر این، جهات انحنای اصلی تحت تغییر شکل‌های سطح ناپایدار هستند.
به عنوان مثال، جهت انحنای اصلی را در قطب شمال (روی محور $z$ مثبت) کره ۲-بعدی $S^2$ تصور کنید:
یک فشردگی بی‌نهایت کوچک کره در امتداد محور $x$ منجر به یک جهت انحنای اصلی در امتداد محور $x$ می‌شود در حالی که یک کشش بی‌نهایت کوچک در امتداد محور $x$ منجر به یک جهت انحنای اصلی در امتداد محور $y$ می‌شود.
ما علاوه بر این می‌خواهیم اشاره کنیم که انحناهای اصلی به جایگذاری یک منیفلد بستگی دارند، یعنی این رویکرد ذاتی نیست.





\paragraph{3DMCNN:}
\citet{jin2018learning} یک \emph{\lr{CNN} مش سه‌بعدی} (3DMCNN) را پیشنهاد کردند که روی سطوح چهره‌های اسکن شده کانوالو می‌کند تا عباراتی مانند شادی، عصبانیت یا تعجب را تشخیص دهد.
از آنجا که ماسک‌های چهره از نظر توپولوژیکی صفحاتی هستند (با سوراخ‌هایی در چشم‌ها)، آنها موازی‌پذیر هستند، که امکان کانولوشن‌های $\GM$ هموار را برای ${G=\{e\}}$ فراهم می‌کند.

کرنل کانولوشن به یک نقطه نمونه‌برداری مرکزی و هشت نقطه دیگر در یک فاصله شعاعی ثابت $R$ و زوایای $\varphi_k = k\frac{2\pi}{8},\ k=0,\dots,7$ در مختصات قطبی گسسته‌سازی می‌شود.
کرنل‌ها -- و در نتیجه چارچوب‌هایی که $\{e\}$-ساختار را تشکیل می‌دهند -- به گونه‌ای چرخانده می‌شوند که با محور $z$ فضای جایگذاری~$\R^3$ تراز شوند.
این رویکرد منطقی به نظر می‌رسد زیرا ماسک‌های چهره موازی‌پذیر و مهمتر از آن، به صورت عمودی تراز شده‌اند.
برای تطبیق یک چنین کرنل جهت‌داری با یک میدان ویژگی، ژئودزیک‌هایی به طول $R$ در هشت جهت شلیک می‌شوند.
مختصات مرکزوار برای درون‌یابی سیگنال از رئوس اطراف به نقطه پایانی ژئودزیک استفاده می‌شود.








\paragraph{کانولوشن‌های انتقال موازی:}
به عنوان آخرین کانولوشن $\{e\}$-راهبری‌پذیر مبتنی بر مش، ما \emph{کانولوشن‌های انتقال موازی} (PTCs) توسط \citet{schonsheck2018parallel} را مورد بحث قرار می‌دهیم.
ایده کلیدی \lr{PTC}ها تعریف کرنل کانولوشن در یک «مبدأ» $p_0 \in M$ و به اشتراک گذاشتن آن با هر مکان دیگر $p\in M$ با انتقال موازی لوی-چیویتا در امتداد کوتاه‌ترین ژئودزیک‌ها بین $p_0$ و~$p$ است.
برای فرمول‌بندی دقیق‌تر این رویه اشتراک وزن، دیسک‌های بسته $B_{\TpM}(0,R) \subset\TpM$ با شعاع $R$ را حول مبدأهای فضاهای مماس در نظر بگیرید، که در آن $R\in\R_+$ شعاع انژکتیویته منیفلد است.
علاوه بر این، فرض کنید $M_{p,R} := \exp_p( B_{\TpM}(0,R)) \subset M$ تصاویر این دیسک‌ها تحت نگاشت نمایی باشند، که شامل تمام نقاطی است که فاصله ژئودزیک آنها از~$p$ کوچکتر یا مساوی~$R$ است.
\citet{schonsheck2018parallel} کرنل‌های کانولوشن اسکالر (نامحدود) خود را به عنوان توابع با مقادیر حقیقی
\begin{align}
    \widehat{K}_{p_0} \!: M_{p_0,R} \to \R
\end{align}
روی همسایگی اطراف مبدأ~$p_0$ یعنی مستقیماً روی منیفلد، تعریف می‌کنند.
برای به اشتراک گذاشتن کرنل با مکان‌های دیگر $p\in M$ نویسندگان کوتاه‌ترین ژئودزیک‌ها را بین $p_0$ و مکان‌های هدف $p$ از طریق الگوریتم پیشروی سریع محاسبه می‌کنند.
سپس آنها کرنل را در امتداد این ژئودزیک‌ها به صورت موازی منتقل می‌کنند، که این کار با پول‌بک کردن آنها به فضاهای مماس انجام می‌شود.
در معادلات، کرنل در $p$ به صورت
\begin{align}\label{eq:PTCs_kernel_transport}
    \widehat{K}_p \!: M_{p,R} \to \R ,\quad
    q \mapsto \widehat{K}_p(q) \,:=\,
    \widehat{K}_{p_0} \circ \exp_{p_0} \circ\,
    \mathcal{P}_{\mkern-2mu\overset{}{\protect\scalebox{.6}{$\!T\!M$}\mkern-2mu,\mkern1mu p_0\to p}}^{-1}
    \circ \log_p (q) \,,
\end{align}
تعریف می‌شود، که با نمودار جابجایی زیر به تصویر کشیده شده است:
\begin{equation}\label{cd:PTC_kernel_1}
\begin{tikzcd}[column sep=50, row sep=10, font=\normalsize]
    M_{p_0,R}
        \arrow[drr, rounded corners, to path={ 
            |-node[below, pos=.8]{\small$\widehat{K}_{p_0}$} ([xshift=-5.ex]\tikztotarget.west) 
            -- (\tikztotarget.west)
            }]
    & B_{T_{\mkern-1.mu p_0}\!M}(0,R)
        \arrow[l, "\exp_{p_0}"']
        \arrow[rr, "\mathcal{P}_{\mkern-2mu\overset{}{\protect\scalebox{.6}{$\!T\!M$}\mkern-2mu,\mkern1mu p_0\to p}}"]
    &[-30pt]
    &[-30pt]
      B_{\TpM}(0,R)
        \arrow[r, "\exp_p"]
    & M_{p,R}
        \arrow[dll, rounded corners, to path={ 
            |-node[below, pos=.8]{\small$\widehat{K}_p$} ([xshift=5.ex]\tikztotarget.east) 
            -- (\tikztotarget.east)
            }]
    \\
    & & \R
\end{tikzcd}
\end{equation}
وجود نگاشت لگاریتمی تضمین شده است زیرا دامنه به نقاط~$q$ در داخل شعاع انژکتیویته محدود شده است.
برای محاسبه پاسخ کانولوشن در $p$ کرنل منتقل شده با میدان ویژگی (اسکالر) روی~$M_{p,R}$ تطبیق داده می‌شود.


برای توصیف \lr{PTC}ها به عنوان کانولوشن‌های $\GM$， ما باید $\{e\}$-ساختار متناظر و کرنل $\{e\}$-راهبری‌پذیر روی~$\R^2$ را شناسایی کنیم.
یک $\{e\}$-ساختار سازگار با انتخاب یک چارچوب دلخواه $\big[e^A_i(p_0)\big]_{i=1}^d$ در مبدأ~$p_0$ ثابت می‌شود.
سپس چارچوب‌ها در هر مکان دیگر $p$ با انتقال لوی-چیویتا این چارچوب اولیه در امتداد کوتاه‌ترین ژئودزیک‌ها تعیین می‌شوند، یعنی به صورت%
\footnote{
    از آنجا که این رابطه $\{e\}$-ساختار را \emph{تعریف} می‌کند، ما باید از انتقال‌دهنده‌های لوی-چیویتا روی کل کلاف چارچوب~$\FM$ استفاده کنیم.
}
\begin{align}
    \big[e^A_i(p) \big]_{i=1}^d\ :=\ 
    \mathcal{P}_{\mkern-2mu\overset{}{\protect\scalebox{.6}{$\!F\!M$}\mkern-2mu,\mkern1mu p_0\to p}}
    \big[e^A_i(p_0)\big]_{i=1}^d \,.
\end{align}
تعریف می‌شوند. توجه داشته باشید که این تعریف به طور خاص رابطه معادل زیر را برای پیمانه‌های متناظر نتیجه می‌دهد، که به راحتی با اعمال آن بر روی میدان چارچوب دیده می‌شود:
\begin{align}\label{eq:PTC_e-structure_gauges}
    \psiGMp^A
    \ =\ 
    \psi_{\protect\scalebox{.6}{$G\!M,\mkern2mu$}\protect\scalebox{.7}{$p_0$}}^A
    \circ
    \mathcal{P}_{\mkern-2mu\overset{}{\protect\scalebox{.6}{$\!G\!M$}\mkern-2mu,\mkern1mu p_0\to p}}^{-1}
\end{align}
با توجه به چارچوب مرجع در~$p_0$ می‌توانیم $\widehat{K}_{p_0}$ را در مختصات نرمال ژئودزیک بیان کنیم، که مفهوم معمول ما از کرنل الگو را روی $\R^2$ به دست می‌دهد:
\begin{align}\label{eq:PTCs_kernel_lift_R2}
    K: B_{\R^2}(0,R) \to \R,
    \quad \mathscr{v} \mapsto K(\mathscr{v}) :=
    \widehat{K}_{p_0} \circ \exp_{p_0} \circ\mkern2mu
    \big( \psi_{\protect\scalebox{.6}{$T\!M,$}\protect\scalebox{.7}{$p_0$}}^A \big)^{-1} (\mathscr{v})
\end{align}
برای نشان دادن اینکه اشتراک وزن ما از طریق $\{e\}$-ساختار ساخته شده به این روش واقعاً با اشتراک وزن \citet{schonsheck2018parallel} سازگار است، ما کرنل‌های $\widehat{K}_p$ را در $p$ با نگاشت کرنل الگوی ما $K$ به منیفلد بازتولید می‌کنیم:
\begin{align}
    K \circ \psiTMp^A \circ \log_p
    \ =&\ \widehat{K}_{p_0} \circ \exp_{p_0} \circ\,
        \big( \psi_{\protect\scalebox{.6}{$T\!M,$}\protect\scalebox{.7}{$p_0$}}^A \big)^{-1}
        \circ \psiTMp^A \circ \log_p \notag \\
    \ =&\ \widehat{K}_{p_0} \circ \exp_{p_0} \circ\,
        \mathcal{P}_{\mkern-2mu\overset{}{\protect\scalebox{.6}{$\!T\!M$}\mkern-2mu,\mkern1mu p_0\to p}}^{-1}
        \circ \log_p \notag \\
    \ =&\ \widehat{K}_p
\end{align}
مرحله دوم در این محاسبه از معادل معادله~\eqref{eq:PTC_e-structure_gauges} برای انتقال‌دهنده و پیمانه‌های کلاف مماس استفاده کرد.
تمام تعاریف، و سازگاری آنها، به طور خلاصه با این گزاره که نمودار زیر جابجایی است، خلاصه می‌شوند:
\begin{equation}\label{cd:PTC_kernel_2}
\begin{tikzcd}[column sep=50, row sep=24, font=\normalsize]
    M_{p_0,R}
        \arrow[ddrr, rounded corners, to path={ 
            |-node[left, pos=.36]{\small$\widehat{K}_{p_0}$} ([xshift=-5.ex]\tikztotarget.west) 
            -- (\tikztotarget.west)
            }]
    & B_{T_{\mkern-1.mu p_0}\!M}(0,R)
        \arrow[l, "\exp_{p_0}"']
        \arrow[rr, "\mathcal{P}_{\mkern-2mu\overset{}{\protect\scalebox{.6}{$\!T\!M$}\mkern-2mu,\mkern1mu p_0\to p}}"]
        \arrow[dr, "\psi_{\protect\scalebox{.6}{$T\!M,$}\protect\scalebox{.7}{$p_0$}}^A"']
    &[-45pt]
    &[-45pt]
      B_{\TpM}(0,R)
        \arrow[dl, "\psiTMp^A"]
        \arrow[r, "\exp_p"]
    & M_{p,R}
        \arrow[ddll, rounded corners, to path={ 
            |-node[right, pos=.36]{\small$\widehat{K}_p$} ([xshift=5.ex]\tikztotarget.east) 
            -- (\tikztotarget.east)
            }]
    \\
    & & B_{\R^2}(0,R)
        \arrow[d, "K"]
    \\
    & & \R
\end{tikzcd}
\end{equation}
از آنجا که ما $\{e\}$-ساختار خود را با انتخاب یک چارچوب اولیه در $p_0$ ساختیم، خواننده ممکن است در مورد پیامدهای این انتخاب کنجکاو باشد.
یک انتخاب متفاوت از چارچوب اولیه منجر به یک تبدیل متناظر از مختصات نرمال ژئودزیک در $p_0$ و در نتیجه از کرنل الگو~$K$ (معادله~\eqref{eq:PTCs_kernel_lift_R2}) خواهد شد.
با این حال، از آنجا که $\{e\}$-ساختار با انتقال چارچوب اولیه ساخته شده است، تمام چارچوب‌های مرجع آن بر این اساس تبدیل خواهند شد.
سپس تبدیل کرنل الگو با تبدیل $\{e\}$-ساختار خنثی خواهد شد به طوری که تمام انتخاب‌های چارچوب‌های اولیه در نهایت معادل هستند.


$\{e\}$-ساختارهای زیربنای \lr{PTC}ها به طور حیاتی به انتخاب مبدأ $p_0$ که میدان چارچوب از آن ساخته شده است، بستگی دارند
-- انتخاب‌های مختلف از مبدأها می‌توانند به $\{e\}$-ساختارهای بسیار متفاوتی منجر شوند.
از آنجا که اکثر منیفلدها با یک مفهوم کانونی از مبدأ همراه نیستند، روش ابتکاری پیشنهادی تا حدی دلخواه به نظر می‌رسد.
$\{e\}$-ساختارهای مبتنی بر انتقال، و در نتیجه \lr{PTC}ها، علاوه بر این در مکان برش ناپیوسته هستند.
این به طور خاص دلالت بر این دارد که آنها نزدیک به مکان برش تحت تغییر شکل‌های هندسه سطوح ناپایدار هستند زیرا چنین تغییر شکل‌هایی ممکن است مکان برش را جابجا کنند.
بر خلاف روش‌های ابتکاری مدل‌های قبلی، روش ابتکاری \lr{PTC}ها صرفاً به هندسه ذاتی سطح بستگی دارد، یعنی بر اساس جایگذاری آن در فضای محیطی نیست.


برای جلوگیری از سردرگمی، باید اشاره کنیم که \citet{schonsheck2018parallel} در پیاده‌سازی خود (بخش ۳.۲) یک میدان چارچوب دیگر را می‌سازند، که نباید با $\{e\}$-ساختاری که در بالا توصیف کردیم، اشتباه گرفته شود.
این میدان چارچوب برای محاسبه عددی اتصال لوی-چیویتا روی مش لازم است، که کرنل‌ها سپس مطابق آن منتقل می‌شوند.
تحلیل ما در بالا صرفاً بر اساس تعریف مستقل از مختصات آنها از مدل است، مهمتر از همه تعریف اشتراک وزن در (معادله ما)~\eqref{eq:PTCs_kernel_transport}.

علاوه بر این توجه داشته باشید که انتقال‌دهنده‌های بردار ویژگی به طور ضمنی فرض شده در پول‌بک انتقال‌دهنده، لزوماً بر اتصال بدیهی $\{e\}$-سازگار که توسط $\{e\}$-ساختار القا می‌شود، تکیه دارند.
انتقال ویژگی در امتداد ژئودزیک‌های خروجی از $p_0$ که $\{e\}$-ساختار بر اساس آنها ساخته شده است، با انتقال‌دهنده‌های لوی-چیویتا منطبق است.
انتقال‌دهنده‌ها در امتداد هر مسیر دیگر به طور کلی با انتقال لوی-چیویتا متفاوت هستند.





\paragraph{کانولوشن‌های مماس:}
\emph{کانولوشن‌های مماس} توسط \citet{tatarchenko2018tangent} روی \emph{ابرهای نقطه} ${P\subset \R^3}$ عمل می‌کنند که فرض می‌شود نقاط آنها روی یک سطح قرار دارند.
فضاهای مماس در نقاط نمونه‌برداری از طریق یک \emph{تحلیل مؤلفه‌های اصلی محلی} (\lr{LPCA}) محاسبه می‌شوند.
\lr{LPCA} در~$p\in P$ اساساً بردارهای ویژه ${e_i \!\in \R^3}$، ${i=\!1,2,3}$ از ماتریس کوواریانس تمام نقاط را در یک همسایگی کروی ${\mathcal{N}_p =} {\{q\in P | \lVert q-p\rVert<R \}}$ با شعاع~$R$ حول~$p$ محاسبه می‌کند.
از آنجا که ابر نقطه از یک سطح نمونه‌برداری شده است، یکی از مقادیر ویژه باید نزدیک به صفر باشد.
بردار ویژه متناظر $e_3$ به عنوان بردار نرمال صفحه مماس جایگذاری شده $\TpM \subset \R^3$ در~$p$ در نظر گرفته می‌شود.
دو بردار ویژه دیگر یک چارچوب راست‌هنجار $[e_1,e_2]$ را روی صفحه مماس تولید می‌کنند، به طوری که مجموعه بردارهای ویژه \lr{LPCA} یک $\{e\}$-ساختار را روی ابر نقطه القا می‌کند.
توجه داشته باشید که بردار ویژه با بزرگترین مقدار ویژه در جهت حداقل انحنای اصلی اشاره می‌کند، یعنی ما $\kappa_n(e_1) = \kappa_{\min}$ و $\kappa_n(e_2) = \kappa_{\max}$ را داریم.
بنابراین $\{e\}$-ساختار در نظر گرفته شده مشابه ساختار \citet{boscaini2015learning} و \citet{monti2017geometric} است، با این حال، چارچوب‌ها با $\pi/2$ چرخانده شده‌اند زیرا با جهت حداقل به جای حداکثر انحنا تراز شده‌اند.%
\footnote{
    از آنجا که تمام چارچوب‌های مرجع با یک زاویه یکسان چرخانده شده‌اند، این تفاوت اگر کرنل‌ها یاد گرفته شوند، بی‌اهمیت است.
}
از آنجا که علامت بردارهای ویژه دلخواه است، این روش ابتکاری در واقع چارچوب‌ها را فقط تا دوران‌هایی با $\pi$ ثابت می‌کند.
برای حل این ابهام، کانولوشن‌های مماس یا باید بین دو جهت تمایز قائل شوند یا به کرنل‌های $\operatorname{C}_2$-راهبری‌پذیر بازگردند.

به جای نمایش میدان ویژگی در مختصات نرمال ژئودزیک، کانولوشن‌های مماس ویژگی‌ها را در امتداد جهت نرمال روی صفحه مماس تصویر می‌کنند.%
\footnote{
    این انتخاب، کانولوشن‌های مماس (و \lr{NPTC-net}ها) را از کانولوشن‌های $\GM$ متفاوت می‌کند.
    در حد کرنل‌های کوچک نسبت به انحنای سطح، هر دو تصویر از میدان‌های ویژگی به فضاهای مماس معادل می‌شوند.
}
سپس آنها به یک شبکه منظم از ${N\times N}$ پیکسل درون‌یابی می‌شوند.
از آنجا که این شبکه با چارچوب مرجع تراز شده است، می‌توان آن را به عنوان یک گسسته‌سازی از مختصاتی‌سازی فضای مماس $\psiTMp^A(\TpM) = \R^2$ در نظر گرفت.
سپس کانولوشن ویژگی‌ها را با گرفتن حاصلضرب داخلی با یک کرنل پیکسلی ${N\times N}$ محاسبه می‌کند.





\paragraph{NPTC-net:}
\citet{jin2019NPTCnet} \emph{\lr{NPTC-net}ها} را روی ابرهای نقطه سطحی~${P\subset\R^3}$ پیشنهاد کردند.
مانند کانولوشن‌های مماس، \lr{NPTC-net}ها صفحات مماس را از طریق یک تحلیل مؤلفه‌های اصلی محلی محاسبه می‌کنند،
با این حال، $\{e\}$-ساختار آنها مستقل از \lr{LPCA} است.
$\{e\}$-ساختار زیربنای \lr{NPTC-net}ها بیشتر با گرادیان تابع فاصله ژئودزیک از یک نقطه اولیه~$p_0 \in P$ تراز شده است.
برای حل تابع فاصله، \citet{jin2019NPTCnet} معادله ایکونال را از طریق یک الگوریتم پیشروی سریع حل می‌کنند.
به جای عمل مستقیم روی ابر نقطه همانطور که به عنوان مثال در~\cite{Crane2017HeatMethodDistance} انجام می‌شود، نویسندگان پیشنهاد می‌کنند از یک شبکه واکسل پراکنده استفاده کنند که واکسل‌های آن در یک نوار باریک اطراف ابر نقطه قرار دارند.
پس از محاسبه تابع فاصله روی شبکه واکسل، که باید فواصل تقریباً ژئودزیک را تولید کند، گرادیان آن محاسبه و روی صفحات مماس تصویر می‌شود.
بردار تصویر شده اولین محورهای چارچوب $\{e\}$-ساختار را تعیین می‌کند.
توجه داشته باشید که چنین میدان‌های چارچوب تعریف شده‌ای در~$p_0$ تکین هستند.

\citet{jin2019NPTCnet} مشاهده می‌کنند که این $\{e\}$-ساختار یک اتصال بدیهی را روی سطح القا می‌کند (به گونه‌ای تعریف شده که میدان چارچوب تحت این انتقال بسته است).
میدان چارچوب (یا کرنل‌های کانولوشن) را می‌توان به عنوان منتقل شده مطابق با این اتصال بدیهی درک کرد، که «PTC» (کانولوشن انتقال موازی) را در نام مدل توجیه می‌کند.
توجه داشته باشید، با این حال، که \lr{NPTC-net}ها بر خلاف \lr{PTC}های \citet{schonsheck2018parallel} بر انتقال لوی-چیویتا تکیه ندارند.
علاوه بر این، این گزاره را می‌توان برای \emph{هر} $\{e\}$-ساختار و اتصال بدیهی متناظر آن بیان کرد.

مانند کانولوشن‌های مماس، \lr{NPTC-net}ها ویژگی‌ها را در فضای محیطی به صفحه مماس تصویر می‌کنند.
به جای استفاده از یک تصویر در امتداد جهت نرمال، نویسندگان از یک درون‌یابی نزدیکترین همسایه با فواصل اندازه‌گیری شده در فضای محیطی استفاده می‌کنند.
سپس کرنل کانولوشن در امتداد چارچوب‌های $\{e\}$-ساختار جهت‌دهی شده و با میدان ویژگی درون‌یابی شده تطبیق داده می‌شود.
با توجه به یک کرنل کانولوشن $K: \R^2 \to \R$ نویسندگان تخصیص آن را به فضاهای مماس به صورت $K \circ \psiTMp^A: \TpM \to \R$ فرمول‌بندی می‌کنند که در آن $\psiTMp^A := (\langle e_1^A,\,v\rangle,\, \langle e_2^A,v\rangle )^\top$ است.
این رویه دقیقاً با تعریف ما از اشتراک وزن و پیمانه‌ها (معادله~\eqref{eq:embedding_gauge_map_orthonormal_frame}) مطابقت دارد.








\paragraph{کانولوشن‌های بین-اطلسی:}
یک رویکرد کاملاً متفاوت توسط \citet{li2019crossAtlas} دنبال شد.
\emph{کانولوشن‌های بین-اطلسی} آنها یک اطلس بافت را محاسبه می‌کنند که چارت‌های آن برای تقریباً ایزومتریک بودن بهینه‌سازی شده‌اند.
سپس عملیات کانولوشن روی اطلس بافت انجام می‌شود، با نگاشت‌های آفست پیکسل که نگاشت‌های گذار بین چارت‌ها را مدل‌سازی می‌کنند.

قبل از اجرای کانولوشن‌های واقعی، یک اطلس از چارت‌ها محاسبه می‌شود.
از دیدگاهی انتزاعی، چارت‌ها تکه‌هایی از سطح را به $\R^2$ نگاشت می‌دهند، به طوری که کل سطح پوشش داده می‌شود.
به طور مشخص، آنها تکه‌هایی از یک میدان ویژگی ورودی $c$-کاناله (بافت) را به روشی بدون همپوشانی به یک آرایه با ابعاد $(X,Y,c)$ نگاشت می‌دهند.
از آنجا که تکه‌ها در آرایه باید تقریباً همسایگی‌های ژئودزیک را روی سطح نمایش دهند، چارت‌ها باید تقریباً ایزومتریک باشند، یعنی اعوجاج‌ها را به حداقل برسانند.
برای برآورده کردن این الزام، سطح به تکه‌هایی بریده می‌شود به طوری که زوایای متقابل بین تمام نرمال‌های مثلث در داخل یک تکه زیر یک آستانه مشخص شده توسط کاربر باقی بماند -- توجه داشته باشید که این رویکرد بر اساس هندسه خارجی سطوح است.
پس از بهینه‌سازی تکه‌ها روی سطح، میدان ویژگی روی هر تکه در امتداد یک جهت تصویر غالب، تصویر می‌شود.
یک الگوریتم بسته‌بندی بن \lr{(icosahedron)} تکه‌های تصویر شده را به طور متراکم در نقشه بافت با شکل $(X,Y,c)$ بسته‌بندی می‌کند.
برای حل ابهام جهتی تکه‌ها، آنها باید \emph{تراز-دورانی} شوند.
این کار با الزام به اینکه تصاویر محور $z$ فضای محیطی به هر تکه، همگی در نقشه بافت تراز شوند، به دست می‌آید.

کانولوشن مستقیماً روی نقشه بافت عمل می‌کند.
این پیکسل‌ها را به سه دسته مختلف گروه‌بندی می‌کند که به روشی متفاوت پردازش می‌شوند.
پیکسل‌هایی که در داخل یک تکه هستند، به طوری که کرنل از تکه خارج نمی‌شود، از طریق کانولوشن‌های اقلیدسی متعارف کانوالو می‌شوند.
از آنجا که چارت‌ها تقریباً ایزومتریک هستند، این تقریباً متناظر با یک کانولوشن ژئودزیک روی نواحی داخلی تکه روی سطح است.
پیکسل‌هایی که خارج از تکه‌ها هستند، پردازش نمی‌شوند و مقدار آنها صفر ثابت می‌شود.
مورد جالب، پیکسل‌هایی هستند که نزدیک به مرز تکه‌ها هستند.
از آنجا که کرنل کانولوشن برای چنین پیکسل‌هایی از تکه فعلی خارج می‌شود، به نگاشت‌های گذار نیاز دارد که ویژگی‌ها را از یک تکه همسایه روی سطح استعلام کنند.
مکان استعلام با
۱) یافتن نقطه اصلی روی سطح که متناظر با مکان فعلی کرنل است،
۲) شلیک یک ژئودزیک برای یافتن مکان نمونه‌برداری کرنل روی سطح و
۳) نگاشت این مکان به پیکسل متناظر در نقشه بافت، محاسبه می‌شود.
با استفاده از این نگاشت‌های گذار، تکه‌ها مطابق با هندسه سطح به هم دوخته می‌شوند و کانولوشن روی نقشه بافت تقریباً متناظر با یک کانولوشن ژئودزیک روی سطح است.
در حد اینکه آستانه زاویه نرمال به سمت صفر برود، تقریب به یک کانولوشن ژئودزیک دقیق همگرا می‌شود.
با این حال، تکه‌ها سپس به وجوه منفرد کوچک می‌شوند، که منجر به نگاشت‌های گذار غیربدیهی‌تری می‌شود.

کانولوشن‌های بین-اطلسی در این حد متناظر با کانولوشن‌های $\GM$ هستند که $\{e\}$-ساختار آنها از چارت‌ها القا می‌شود.
$\{e\}$-ساختار در مرزهای بین تکه‌های مجاور ناپیوسته است، با این حال، پرش‌ها به دلیل تراز دورانی تکه‌ها در نقشه بافت باید در اکثر موارد به حداقل برسند.
انتظار می‌رود ناپیوستگی‌ها در تکه‌هایی از سطح که تقریباً افقی هستند، بزرگ باشند.

برای کامل بودن، ما به روش‌های مبتنی بر اطلس توسط \citet{sinha2016deep} و \citet{maron2017convolutional} اشاره می‌کنیم.
هر دو تصویرهای \emph{غیر-ایزومتریک} از سطح را به یک دامنه مسطح در نظر می‌گیرند، که این دلالت بر این دارد که کانولوشن‌های اقلیدسی بعدی متناظر با کانولوشن‌های ژئودزیک روی سطح نیستند.